<div class="problembody">
<p>In an infinite binary tree:</p>
<ul class="itemize">
<li>
<p>Each node has exactly two children – a left and a right
        child.</p>
</li>
<li>
<p>If a node is labeled with the integer <span class="tex2jax_process">$X$</span>, then its left child is
        labeled <span class="tex2jax_process">$2X$</span> and its
        right child <span class="tex2jax_process">$2X+1$</span>.</p>
</li>
<li>
<p>The root of the tree is labeled 1.</p>
</li>
</ul>
<p>A walk on the binary tree starts in the root. Each step in
    the walk is either a jump onto the left child, onto the right
    child, or pause for rest (stay in the same node).</p>
<p>A walk is described with a string of letters ’L’, ’R’ and
    ’P’:</p>
<ul class="itemize">
<li>
<p>’L’ represents a jump to the left child;</p>
</li>
<li>
<p>’R’ represents a jump to the right child;</p>
</li>
<li>
<p>’P’ represents a pause.</p>
</li>
</ul>
<p>The <em>value</em> of the walk is the label of the node we
    end up on. For example, the value of the walk LR is 5, while
    the value of the walk RPP is 3.</p>
<p>A <em>set</em> of walks is described by a string of
    characters ’L’, ’R’, ’P’ and ’*’. Each ’*’ can be any of the
    three moves; the set of walks contains all walks matching the
    pattern.</p>
<p>For example, the set L*R contains the walks LLR, LRR and
    LPR. The set ** contains the walks LL, LR, LP, RL, RR, RP, PL,
    PR and PP.</p>
<p>Finally, the <em>value of a set of walks</em> is the sum of
    values of all walks in the set. Calculate the value of the
    given set of walks.</p>
<h2>Input</h2>
<p>A string describing the set. Only characters ’L’, ’R’, ’P’
    and ’*’ will appear and there will be at most <span class="tex2jax_process">$10\, 000$</span> of them.</p>
<h2>Output</h2>
<p>Output the value of the set.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
P*P
</pre>
</td>
<td>
<pre>
6
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
L*R
</pre>
</td>
<td>
<pre>
25
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>
**
</pre>
</td>
<td>
<pre>
33
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 4</th>
<th>Sample Output 4</th>
</tr>
<tr>
<td>
<pre>
LLLLLRRRRRLLLLLRRRRRLLLLLRRRRRLLLLL
</pre>
</td>
<td>
<pre>
35400942560
</pre>
</td>
</tr>
</table>
</div>