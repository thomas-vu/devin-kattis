<div class="problembody">
<p>Your factory has <span class="tex2jax_process">$N$</span>
    junctions (numbered from <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$N$</span>) connected by <span class="tex2jax_process">$M$</span> conveyor belts. Each conveyor belt
    transports any product automatically from one junction to
    another junction in exactly one minute. Note that each conveyor
    belt only works in one direction. There can be more than one
    conveyor belt connecting two junctions, and there can be a
    conveyor belt connecting a junction to itself.</p>
<p>There are <span class="tex2jax_process">$K$</span> producers
    (machines which produce the products) located at the first
    <span class="tex2jax_process">$K$</span> junctions, i.e.
    junctions <span class="tex2jax_process">$1, 2, \ldots ,
    K$</span>. The producer at junction <span class="tex2jax_process">$j$</span> produces an product each minute
    <span class="tex2jax_process">$(x \cdot K + j)$</span> for all
    integers <span class="tex2jax_process">$x \ge 0$</span> and
    <span class="tex2jax_process">$j = 1, 2, \ldots , K$</span>.
    All products are transported immediately via the conveyor belts
    to the warehouse at junction <span class="tex2jax_process">$N$</span>, except for those produced at
    junction <span class="tex2jax_process">$N$</span> (if any).
    Items produced at junction <span class="tex2jax_process">$N$</span> are directly delivered to the
    warehouse (there is no need to use the conveyor belts).</p>
<p>At each junction, there is a robot deciding which conveyor
    belts the incoming product should go to in a negligible time
    (instantly). The robots can be programmed such that all
    products produced by a producer are always delivered to the
    warehouse via the same route. Once the robots are programmed,
    the routing can no longer be changed. Items from different
    producers may have the same or different routes.</p>
<p>A prudent potential investor comes and wants to inspect the
    factory before making any decision. You want to show to the
    potential investor that your factory employs a good risk
    management policy. Thus, you want to make sure that each
    conveyor belt only transports at most one product at any time;
    i.e. two products cannot be on the same conveyor belt at the
    same time. On the other hand, there is no limit on the number
    of products at the junctions (the robots have a lot of arms!).
    To achieve this, you may turn off zero or more producers, but
    you still want to maximize the production, hence, this
    problem.</p>
<p>Find the maximum number of producers that can be left
    running such that all the produced products can be delivered to
    the warehouse and each conveyor belt transports at most
    <span class="tex2jax_process">$1$</span> product at any
    time.</p>
<h2>Input</h2>
<p>The first line contains three integers <span class="tex2jax_process">$N$</span>, <span class="tex2jax_process">$K$</span>, and <span class="tex2jax_process">$M$</span> (<span class="tex2jax_process">$1
    \le K \le N \le 300$</span>; <span class="tex2jax_process">$0
    \le M \le 1\, 000$</span>) representing the number of
    junctions, the number of producers, and the number of conveyor
    belts, respectively.</p>
<p>The next <span class="tex2jax_process">$M$</span> lines,
    each contains two integers <span class="tex2jax_process">$a$</span> and <span class="tex2jax_process">$b$</span> (<span class="tex2jax_process">$1
    \le a, b \le N$</span>) representing a conveyor belt connecting
    junction <span class="tex2jax_process">$a$</span> and junction
    <span class="tex2jax_process">$b$</span> with the direction
    from <span class="tex2jax_process">$a$</span> to <span class="tex2jax_process">$b$</span>.</p>
<h2>Output</h2>
<p>The output contains an integer denoting the maximum number
    of producers which can be left running such that all the
    produced products can be delivered to the warehouse and each
    conveyor belt transports at most one product at any time.</p>
<h2>Explanation</h2>
<p>In Sample Input <span class="tex2jax_process">$1$</span>,
    <span class="tex2jax_process">$N = 4$</span>, <span class="tex2jax_process">$K = 2$</span>, <span class="tex2jax_process">$M = 3$</span>, and the directed edges are
    <span class="tex2jax_process">$\{ (1,3)$</span>, <span class="tex2jax_process">$(2,3)$</span>, <span class="tex2jax_process">$(3,4)\} $</span>. There is only one possible
    delivery route for each producer, i.e. <span class="tex2jax_process">$1 \rightarrow 3 \rightarrow 4$</span> for
    producer <span class="tex2jax_process">$1$</span>, and
    <span class="tex2jax_process">$2 \rightarrow 3 \rightarrow
    4$</span> for producer <span class="tex2jax_process">$2$</span>. Both producers are using conveyor
    belt <span class="tex2jax_process">$(3,4)$</span>, however, the
    products from producer <span class="tex2jax_process">$1$</span>
    are on the conveyor belt <span class="tex2jax_process">$(3,4)$</span> on minutes <span class="tex2jax_process">$2, 4, 6, \dots $</span> (even minutes),
    while the products from producer <span class="tex2jax_process">$2$</span> are on the conveyor belt
    <span class="tex2jax_process">$(3,4)$</span> on minutes
    <span class="tex2jax_process">$3, 5, 7, \dots $</span> (odd
    minutes). Therefore, both producers can be left running.</p>
<p>In Sample Input <span class="tex2jax_process">$2$</span>,
    <span class="tex2jax_process">$N = 5$</span>, <span class="tex2jax_process">$K = 2$</span>, <span class="tex2jax_process">$M = 4$</span>, and the directed edges are
    <span class="tex2jax_process">$\{ (1,3)$</span>, <span class="tex2jax_process">$(3,4)$</span>, <span class="tex2jax_process">$(2,4)$</span>, <span class="tex2jax_process">$(4,5)\} $</span>. Similar to the previous
    example, there is only one possible delivery route for each
    product produced by each producer. In this example, only one
    producer can be left running as products from both producers
    (<span class="tex2jax_process">$1$</span> and <span class="tex2jax_process">$2$</span>) are on the conveyor belt
    <span class="tex2jax_process">$(4,5)$</span> at the same time
    if both are running.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>4 2 3
1 3
2 3
3 4
</pre>
</td>
<td>
<pre>2
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>5 2 4
1 3
3 4
2 4
4 5
</pre>
</td>
<td>
<pre>1
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>5 2 6
1 4
2 3
3 4
4 5
2 4
3 3
</pre>
</td>
<td>
<pre>2
</pre>
</td>
</tr>
</table>
</div>