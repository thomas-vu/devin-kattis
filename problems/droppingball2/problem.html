<div class="problembody">
<p>In the second round of the Hunter Exam, the candidates are
    faced with an even more challenging problem, requiring both
    agility and mathematical skills.</p>
<p>After entering the Examination Hall for the second round,
    candidates are faced with a huge vertical grid containing empty
    spaces, obstacles and conveyor belts. The grid is composed of
    <span class="tex2jax_process">$K$</span> identical parts, each
    of size <span class="tex2jax_process">$(R+1) \times C$</span>,
    stacking vertically on top of each other. In order to pass the
    exam, each candidate must drop exactly one ball into this grid
    and get the maximum possible score.</p>
<p>Below is a sample grid with <span class="tex2jax_process">$R
    = 2$</span>, <span class="tex2jax_process">$C = 5$</span> and
    <span class="tex2jax_process">$K = 2$</span>:</p>
<center>
<img alt="\includegraphics[width=0.30\textwidth ]{illustration.jpg}" src="/problems/droppingball2/file/statement/en/img-0001.jpg" style="width:30.00%"/>
</center>
<p>Each cell in the grid can be one of the following:</p>
<ul class="itemize">
<li>
<p>Empty space (colored white in the above image). The ball
        falls through it.</p>
</li>
<li>
<p>Obstacle blocking the ball from moving (colored black in
        the above image). If the ball lands on top of an obstacle,
        it cannot go anywhere and the exam ends.</p>
</li>
<li>
<p>Conveyor belt (colored yellow in the above image). All
        conveyor belts are horizontal and have either left or right
        direction. Some belts’ direction have been fixed, and you
        have to set the direction for the others. Based on its
        direction, a belt sends the ball one unit to the left or to
        the right. If the ball is sent outside of the grid or to an
        obstacle, your exam ends immediately.</p>
<ul class="itemize">
<li>
<p>In the above grid, ‘R’ and ‘L’ represent a conveyor
            bell which was already set to right and left,
            respectively, and ‘?’ represents a conveyor bell which
            is not yet set.</p>
</li>
<li>
<p>Note that two belts in two different parts are
            considered different. You can set different directions
            for them, even though they are in the same position in
            respect to their parts.</p>
</li>
</ul>
</li>
<li>
<p>Cell with points (colored blue in the above image). A
        cell belongs to this kind if and only if it is on the last
        row of some part. This cell contains an integer — the
        score you gain when the ball lands on this cell. Note that
        the ball will fall through this square and begins a new
        part, or if that’s the last part, the exam ends.</p>
</li>
</ul>
<p>As the time for the exam is limited, the exam will also end
    when the ball goes through <span class="tex2jax_process">$10^{20}$</span> cells.</p>
<p>Your final score in this exam is the sum of score you get
    when the exam ends. You don’t have to make the ball fall to the
    bottom. To pass the exam, you must find a way to set the
    conveyor belts and set the initial position of the ball to
    maximize the final score. Can you do it?</p>
<h2>Input</h2>
<p>The first line of the input contains <span class="tex2jax_process">$3$</span> integers <span class="tex2jax_process">$R$</span>, <span class="tex2jax_process">$C$</span> and <span class="tex2jax_process">$K$</span>. <span class="tex2jax_process">$(1
    \le R, C \le 50, 1 \le K \le 10^9)$</span>.</p>
<p>In the next <span class="tex2jax_process">$R$</span> line,
    the <span class="tex2jax_process">$i$</span>-th line contains
    exactly <span class="tex2jax_process">$C$</span> characters.
    Each character can be one of the following:</p>
<ul class="itemize">
<li>
<p>‘.’, representing an empty space.</p>
</li>
<li>
<p>‘X’, representing an obstacle.</p>
</li>
<li>
<p>‘R’, representing a conveyor belt, which is already set
        to right.</p>
</li>
<li>
<p>‘L’, representing a conveyor belt, which is already set
        to left.</p>
</li>
<li>
<p>‘?’, representing a conveyor belt, which is not yet
        set.</p>
</li>
</ul>
<p>The last line of the input contains exactly <span class="tex2jax_process">$C$</span> integers. The <span class="tex2jax_process">$i$</span>-th number, <span class="tex2jax_process">$a_ i$</span>, represents the score in the
    <span class="tex2jax_process">$i$</span>-th column in the last
    row. <span class="tex2jax_process">$(1 \le a_ i \le
    10^9)$</span>.</p>
<h2>Output</h2>
<p>Output contains a single integer — the maximum final
    score.</p>
<h2>Explanation for the first example</h2>
<p>We can set the conveyor belt in the first row to ‘R’ and the
    conveyor belt in the <span class="tex2jax_process">$4$</span>th
    row to ‘L’, then drop the ball from the <span class="tex2jax_process">$4$</span>-th column.</p>
<center>
<img alt="\includegraphics[width=0.30\textwidth ]{illustration2.jpg}" src="/problems/droppingball2/file/statement/en/img-0002.jpg" style="width:30.00%"/>
</center>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>2 5 2
R..?.
.X...
100 100 7 100 8
</pre>
</td>
<td>
<pre>16
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>2 3 1
X..
.?.
10 1000 1
</pre>
</td>
<td>
<pre>10
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>2 3 100
X..
.?.
10 1000 1
</pre>
</td>
<td>
<pre>100
</pre>
</td>
</tr>
</table>
</div>