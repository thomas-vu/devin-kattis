<div class="problembody">
<p>Last summer, Carla the Cartographer went on an expedition on
    behalf of the National Center for Positioning and Charting (the
    NCPC). The goal was to measure water flows of a river system
    far away in the north. However, the area is quite remote and
    Carla is not the adventurous type, so she was only able to
    measure the water flows in some of the locations. Carla is now
    worried that the NCPC will send her back to this wilderness
    next summer, so she consulted some algorithm experts (you) to
    see if it is possible to reconstruct the missing data.</p>
<p>The river system is represented by a rooted tree with
    <span class="tex2jax_process">$n$</span> vertices numbered from
    <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$n$</span>. The leaves of this tree are the
    sources, and the other vertices correspond to confluences
    (places where multiple rivers join together). Water flows from
    higher-numbered vertices to lower-numbered vertices. Vertex
    <span class="tex2jax_process">$1$</span>, the root of the tree,
    is the mouth of the river system, where it flows into the
    ocean. The water flow of a source can be any positive integer,
    while the water flow of a confluence is the sum of the water
    flows of its children. You will be given this tree along with
    the water flows at some of its vertices, and your task is to
    find the water flows at all the vertices or determine that this
    is impossible.</p>
<div class="figure" id="a0000000004">
<center>
<img alt="\includegraphics[width=0.43\textwidth ]{sample1}" src="/problems/flowfinder/file/statement/en/img-0001.png" style="width:43.00%"/>
<div class="caption">
<b>Figure 1</b>: Illustration of Sample Input 1 and its
          solution. Water flows from left to right. The flows shown
          in red, from vertices <span class="tex2jax_process">$1$</span>, <span class="tex2jax_process">$5$</span>, <span class="tex2jax_process">$7$</span> and <span class="tex2jax_process">$9$</span>, are not given but can be
          deduced to be <span class="tex2jax_process">$9$</span>,
          <span class="tex2jax_process">$2$</span>, <span class="tex2jax_process">$3$</span> and <span class="tex2jax_process">$1$</span> respectively.
        </div>
</center>
</div>
<h2>Input</h2>
<p>The first line of input contains an integer <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$2
    \leq n \leq 3 \cdot 10^5$</span>), the number of vertices in
    the tree. Then follows a line containing <span class="tex2jax_process">$n-1$</span> integers <span class="tex2jax_process">$p_2, \ldots , p_{n}$</span> (<span class="tex2jax_process">$1 \le p_ i &lt; i$</span>), where
    <span class="tex2jax_process">$p_ i$</span> is the number of
    the parent of vertex <span class="tex2jax_process">$i$</span>.</p>
<p>Finally there is a line containing <span class="tex2jax_process">$n$</span> integers <span class="tex2jax_process">$a_1, \ldots , a_ n$</span> (<span class="tex2jax_process">$0 \le a_ i \le 10^9$</span>), where
    <span class="tex2jax_process">$a_ i$</span> represents the
    water flow at vertex <span class="tex2jax_process">$i$</span>.
    If <span class="tex2jax_process">$a_ i$</span> is equal to
    <span class="tex2jax_process">$0$</span>, then the water flow
    at that vertex is unknown. Otherwise, <span class="tex2jax_process">$a_ i$</span> is equal to the water flow at
    vertex <span class="tex2jax_process">$i$</span>. Note that the
    upper bound <span class="tex2jax_process">$10^9$</span> on
    <span class="tex2jax_process">$a_ i$</span> does not apply to
    the unknown values, they can be any positive integer.</p>
<h2>Output</h2>
<p>If all the <span class="tex2jax_process">$n$</span> water
    flows can be reconstructed uniquely, then output them in
    increasing order of vertex number. Otherwise, output
    “<tt class="ttfamily">impossible</tt>”. Note that it is
    possible that there is no way of reconstructing the water flows
    (if the data provided by Carla is inconsistent somehow). In
    that case you should also output “<tt class="ttfamily">impossible</tt>”.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>10
1 2 3 2 1 6 7 7 6
0 4 2 2 0 5 0 2 0 2
</pre>
</td>
<td>
<pre>9
4
2
2
2
5
3
2
1
2
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>5
1 2 2 1
4 0 0 0 1
</pre>
</td>
<td>
<pre>impossible
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>4
1 1 1
3 2 1 0
</pre>
</td>
<td>
<pre>impossible
</pre>
</td>
</tr>
</table>
</div>