<div class="problembody">
<p>You are a righteous knight in a kingdom with <span class="tex2jax_process">$N$</span> villages with <span class="tex2jax_process">$M$</span> bidirectional roads. The villages
    are labeled from <span class="tex2jax_process">$1$</span> to
    <span class="tex2jax_process">$N$</span> while the roads are
    labeled from <span class="tex2jax_process">$1$</span> to
    <span class="tex2jax_process">$M$</span>. The <span class="tex2jax_process">$i$</span>-th road connects two <b class="bfseries">different</b> villages <span class="tex2jax_process">$A_ i$</span> and <span class="tex2jax_process">$B_ i$</span> with a length of <span class="tex2jax_process">$W_ i$</span>. No two roads connect the same
    pair of villages.</p>
<p>You are requested by your King to deliver a message between
    two palaces located at village <span class="tex2jax_process">$X$</span> and village <span class="tex2jax_process">$Y$</span>. You want to find the shortest
    path between the two villages, but unfortunately... There are
    evil shamans on your way! Worse, some of them also transformed
    themselves into titans! Specifically, for the <span class="tex2jax_process">$i$</span>-th road:</p>
<ul class="itemize">
<li>
<p>If <span class="tex2jax_process">$C_ i = 0$</span>, then
        <span class="tex2jax_process">$i$</span>-th road has no
        enemy.</p>
</li>
<li>
<p>If <span class="tex2jax_process">$C_ i = 1$</span>, then
        <span class="tex2jax_process">$i$</span>-th road has a
        shaman.</p>
</li>
<li>
<p>If <span class="tex2jax_process">$C_ i = 2$</span>, then
        <span class="tex2jax_process">$i$</span>-th road has a
        titan.</p>
</li>
</ul>
<p>You are brave and powerful enough to slay the enemies (i.e.
    shamans and titans), but you just prefer to avoid them,
    especially the titans. So you want to find the best path from
    village <span class="tex2jax_process">$X$</span> to village
    <span class="tex2jax_process">$Y$</span> such that, ordered by
    your priority:</p>
<ol class="enumerate">
<li>
<p>You want the total number of titans you encountered to
        be as few as possible.</p>
</li>
<li>
<p>You want the total number of shamans you encountered to
        be as few as possible.</p>
</li>
<li>
<p>You want the shortest path.</p>
</li>
</ol>
<p>Can you help yourself by finding an algorithm to fend off
    titan?</p>
<h2>Input</h2>
<p>The first line contains four integers: <span class="tex2jax_process">$N~ (2 \le N \le 100)$</span>, <span class="tex2jax_process">$M~ (0 \le M \le \frac{N \times
    (N-1)}{2})$</span>, <span class="tex2jax_process">$X~ (1 \le X
    \le N)$</span>, and <span class="tex2jax_process">$Y~ (1 \le Y
    \le N, X \neq Y)$</span>.</p>
<p>The next <span class="tex2jax_process">$M$</span> lines
    contain the roads, each on one line. Each road is given in the
    form of four integers, <span class="tex2jax_process">$A_ i~ (1
    \le A_ i \le N)$</span>, <span class="tex2jax_process">$B_ i~
    (1 \le B_ i \le N)$</span>, <span class="tex2jax_process">$W_
    i~ (1 \le W_ i \le 1~ 000~ 000~ 000)$</span>, and <span class="tex2jax_process">$C_ i~ (0 \le C_ i \le 2)$</span>.</p>
<h2>Output</h2>
<p>Print the total length, the total number of shamans, and the
    total number of titans in the best possible path. If you cannot
    go from village <span class="tex2jax_process">$X$</span> to
    village <span class="tex2jax_process">$Y$</span>, print
    “<tt class="ttfamily">IMPOSSIBLE</tt>” instead.</p>
<h2>Subtasks</h2>
<ol class="enumerate">
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$18$</span> Points</b>): <span class="tex2jax_process">$M=N-1$</span>, <span class="tex2jax_process">$A_ i = i$</span> and <span class="tex2jax_process">$B_ i = i+1$</span>, <span class="tex2jax_process">$\forall i \in [1..M]$</span>.</p>
</li>
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$17$</span> Points</b>): <span class="tex2jax_process">$M=N-1$</span> and all villages are
        connected.</p>
</li>
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$7$</span> Points</b>): <span class="tex2jax_process">$C_ i = 0$</span>, <span class="tex2jax_process">$\forall i \in [1..M]$</span>.</p>
</li>
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$19$</span> Points</b>): <span class="tex2jax_process">$C_ i = 1$</span>, <span class="tex2jax_process">$\forall i \in [1..M]$</span>.</p>
</li>
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$27$</span> Points</b>): <span class="tex2jax_process">$C_ i \leq 1$</span>, <span class="tex2jax_process">$\forall i \in [1..M]$</span>.</p>
</li>
<li>
<p>(<b class="bfseries"><span class="tex2jax_process">$12$</span> Points</b>): No additional
        constraint.</p>
</li>
</ol>
<h2>Explanation of Sample 1</h2>
<p>There is only one possible path from village <span class="tex2jax_process">$4$</span> to village <span class="tex2jax_process">$1$</span>. The path has length of
    <span class="tex2jax_process">$13$</span> and you have to
    encounter <span class="tex2jax_process">$0$</span> shamans and
    <span class="tex2jax_process">$2$</span> titans in total.</p>
<div class="figure">
<center>
<img alt="\includegraphics[width=0.6\textwidth ]{sample1}" src="/problems/fendofftitan/file/statement/en/img-0001.png" style="width:60.00%"/>
</center>
</div>
<h2>Explanation of Sample 2</h2>
<p>There is actually a direct road from village <span class="tex2jax_process">$1$</span> to village <span class="tex2jax_process">$6$</span>. However, the only titan in the
    whole kingdom is there, thus you should consider other paths.
    The shaman between village <span class="tex2jax_process">$2$</span> and village <span class="tex2jax_process">$3$</span> is avoidable, but the one between
    village <span class="tex2jax_process">$5$</span> and village
    <span class="tex2jax_process">$6$</span> is not. The shortest
    path for you to encounter just <span class="tex2jax_process">$1$</span> shaman is: <span class="tex2jax_process">$1-2-4-3-5-6$</span> with a total length of
    <span class="tex2jax_process">$24$</span>.</p>
<div class="figure">
<center>
<img alt="\includegraphics[width=0.5\textwidth ]{sample2}" src="/problems/fendofftitan/file/statement/en/img-0002.png" style="width:50.00%"/>
</center>
</div>
<h2>Explanation of Sample 3</h2>
<p>As village <span class="tex2jax_process">$3$</span> is
    isolated, it is impossible to reach it from village
    <span class="tex2jax_process">$1$</span>.</p>
<div class="figure">
<center>
<img alt="\includegraphics[width=0.2\textwidth ]{sample3}" src="/problems/fendofftitan/file/statement/en/img-0003.png" style="width:20.00%"/>
</center>
</div>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>5 4 4 1
1 2 4 2
2 3 6 0
3 4 3 2
4 5 2 1
</pre>
</td>
<td>
<pre>13 0 2
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>6 8 1 6
1 6 5 2
1 2 10 0
2 3 2 1
3 4 4 0
4 2 6 0
3 5 1 0
4 5 9 0
5 6 3 1
</pre>
</td>
<td>
<pre>24 1 0
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>3 1 1 3
1 2 1 0
</pre>
</td>
<td>
<pre>IMPOSSIBLE
</pre>
</td>
</tr>
</table>
</div>