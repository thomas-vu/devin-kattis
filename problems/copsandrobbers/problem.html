<div class="problembody">
<p>The First Universal Bank of Denview has just been robbed!
    You want to catch the robbers before they leave the state.</p>
<p>The state of Calirado can be represented by a rectangular
    <span class="tex2jax_process">$n$</span>-by-<span class="tex2jax_process">$m$</span> grid of characters, with the
    character in each grid cell denoting a terrain type. The
    robbers begin within the cell marked ‘<tt class="tt">B</tt>’,
    indicating the Bank of Denview. They will then travel across
    the state by moving from grid cell to grid cell in the four
    cardinal directions (left, right, up, down). (Note that the
    robbers pass only through grid edges, and not corners.) If the
    robbers manage to leave the state (by crossing any boundary
    edge of the grid) they will go into hiding, never to be seen
    again. You must stop this.</p>
<p>To catch the robbers, you can set up barricades. Barricades
    are placed inside a grid cell, and prevent the robbers from
    traveling into the cell (from any direction). Each grid square
    consists of a different type of terrain, with different cost
    for placing a barricade. You cannot place a barricade on the
    bank (‘<tt class="tt">B</tt>’) or on any cell containing a dot
    (‘<tt class="tt">.</tt>’), though the robbers can travel freely
    through these cells. Every other cell will contain a lowercase
    English letter, indicating a terrain type.</p>
<p>Find the cheapest way to prevent the robbers from escaping
    Calirado.</p>
<h2>Input</h2>
<p>The first line contains three integers <span class="tex2jax_process">$n$</span>, <span class="tex2jax_process">$m$</span>, and <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">$1
    \le n, m \le 30$</span>, <span class="tex2jax_process">$1 \le c
    \le 26$</span>): the dimensions of the grid representing
    Calirado, and the number of different terrain types. Then
    follows <span class="tex2jax_process">$m$</span> lines of
    exactly <span class="tex2jax_process">$n$</span> characters
    each: the map of Calirado. Each character is either ‘<tt class="tt">B</tt>’, ‘<tt class="tt">.</tt>’, or one of the first
    <span class="tex2jax_process">$c$</span> lowercase letters of
    the English alphabet. Calirado is guaranteed to contain exactly
    one bank. After the grid, there is a line containing
    <span class="tex2jax_process">$c$</span> space-separated
    integers <span class="tex2jax_process">$1 \leq c_ i \leq 100\,
    000$</span>, the costs of placing a barricade on a grid cell of
    each terrain type. <span class="tex2jax_process">$c_1$</span>
    is the cost for terrain type ‘<tt class="tt">a</tt>’,
    <span class="tex2jax_process">$c_2$</span> is the cost for
    ‘<tt class="tt">b</tt>’, and so forth.</p>
<h2>Output</h2>
<p>Print one integer, the minimum total cost of the barricades
    that you need to place to prevent the robbers from escaping. If
    there is no way to prevent the robbers from escaping, print
    <tt class="tt">-1</tt> instead.</p>
<p>In the first example, the minimum cost is to barricade the
    central three squares on each side of the bank for a total cost
    of <span class="tex2jax_process">$12$</span>.</p>
<p>In the second example, since the bank is on the border,
    there is no way to prevent the robbers from escaping the
    state.</p>
<p>In the third example, we must prevent the robbers from
    leaving the bank to the top, bottom, and right, or else we
    cannot prevent them from leaving the state. To the left,
    however, it is cheaper to allow passage through the ‘<tt class="tt">b</tt>’ cell, and then barricade in each of the three
    directions from there. The total cost is <span class="tex2jax_process">$7 + 5 + 7 + 3(1) = 22$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>5 5 1
aaaaa
a...a
a.B.a
a...a
aaaaa
1
</pre>
</td>
<td>
<pre>12
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>2 2 1
aB
aa
1
</pre>
</td>
<td>
<pre>-1
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>4 3 3
.abc
abBc
.abc
1 7 5
</pre>
</td>
<td>
<pre>22
</pre>
</td>
</tr>
</table>
</div>