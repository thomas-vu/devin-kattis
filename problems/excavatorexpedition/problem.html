<div class="problembody">
<div class="illustration" style="width:40.00%">
<img alt="/problems/excavatorexpedition/file/statement/en/img-0001.jpg" class="illustration" src="/problems/excavatorexpedition/file/statement/en/img-0001.jpg"/>
<div class="description">
        Photo by <a href="https://unsplash.com/photos/8eDOHGxQtuI">Markus Spiske</a>
</div>
</div>
<p>Little Nanouk is obsessed with excavators. In fact, he is so
    obsessed with them that he will throw a tantrum if he doesn’t
    see too many during a road trip.</p>
<p>This poses a problem for his mother Amka, who wants to bring
    him to his grandparents today. To make the drive to his
    grandparents as smooth as possible, she has plotted out all the
    construction sites they could see on their way, along with the
    “boring” sites (according to Nanouk). Of course, Amka also
    wants to make some progress for each place they drive to. For
    that reason, the map she has plotted out is a directed acyclic
    graph.</p>
<p>Could you help Amka find the route to their grandparents
    which makes Nanouk as happy as possible?</p>
<h2>Input</h2>
<p>First, a single line with two integers <span class="tex2jax_process">$V$</span> and <span class="tex2jax_process">$E$</span> is given. Then, a single line with
    <span class="tex2jax_process">$V$</span> characters is given,
    where <span class="tex2jax_process">$V_ i$</span> is
    ‘<tt class="ttfamily">X</tt>’ if location <span class="tex2jax_process">$i$</span> is a construction site, and
    ‘<tt class="ttfamily">.</tt>’ if it is a boring site.</p>
<p>Then follow <span class="tex2jax_process">$E$</span> lines.
    Every line contains two integers <span class="tex2jax_process">$F_ i$</span> and <span class="tex2jax_process">$T_ i$</span>, representing that it is
    possible to drive from <span class="tex2jax_process">$F_
    i$</span> to <span class="tex2jax_process">$T_ i$</span>.</p>
<p>The location <span class="tex2jax_process">$0$</span> and
    <span class="tex2jax_process">$V-1$</span> are Amka’s home and
    Nanouk’s grandparents’ home, respectively.</p>
<h2>Output</h2>
<p>Output the happiness of Nanouk if Amka drives the route
    which maximises Nanouk’s happiness. Nanouk’s happiness is
    defined as the number of construction sites visited, minus the
    number of boring sites (except for Amka’s and Nanouk’s
    grandparents’ house).</p>
<h2>Limits</h2>
<ul class="itemize">
<li>
<p><span class="tex2jax_process">$1 &lt; V \leq 400\,
        000$</span></p>
</li>
<li>
<p><span class="tex2jax_process">$0 &lt; E \leq 400\,
        000$</span></p>
</li>
<li>
<p><span class="tex2jax_process">$0 \leq F_ i, T_ i &lt;
        V$</span></p>
</li>
<li>
<p>For all <span class="tex2jax_process">$0 &lt; i &lt;
        V$</span>, <span class="tex2jax_process">$V_ i \in $</span>
        {‘<tt class="ttfamily">.</tt>’, ‘<tt class="ttfamily">X</tt>’}</p>
</li>
<li>
<p>For <span class="tex2jax_process">$i \in \{ 0, V-1\}
        $</span>, <span class="tex2jax_process">$V_ i =$</span>
        ‘<tt class="ttfamily">.</tt>’</p>
</li>
<li>
<p>There is always a path from Amka’s house to Nanouk’s
        grandparents.</p>
</li>
<li>
<p>There are no cycles in the graph.</p>
</li>
</ul>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>13 15
.X...X.X...X.
0 1
0 2
1 3
2 4
3 5
4 5
5 6
5 7
5 8
6 12
7 9
8 10
9 11
10 11
11 12
</pre>
</td>
<td>
<pre>2
</pre>
</td>
</tr>
</table>
</div>