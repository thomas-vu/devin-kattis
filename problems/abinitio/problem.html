<div class="problembody">
<p><i class="itshape">“A journey of a thousand miles begins
    with a single step.” ­–Lao Tzu.</i></p>
<p>When someone is studying competitive programming from the
    beginning, he or she is said to be a student of competitive
    programming <i class="itshape">ab initio</i>. Students should
    be given relatively easy problems to begin their journeys,
    before they are gradually given more difficult problems.</p>
<p>Here is an example of an easy problem that does not even
    need a description.</p>
<h2>Input</h2>
<p>The first line of input contains three integers <span class="tex2jax_process">$V$</span> (<span class="tex2jax_process">$2
    \leq V \leq 2\, 000$</span>), <span class="tex2jax_process">$E$</span> (<span class="tex2jax_process">$1
    \leq E \leq 200\, 000$</span>), and <span class="tex2jax_process">$Q$</span> (<span class="tex2jax_process">$1
    \leq Q \leq 2\, 000$</span>), the number of vertices, the
    number of edges and the number of queries that must be
    performed on a <i class="itshape">directed</i>, <i class="itshape">unweighted</i> graph <span class="tex2jax_process">$G$</span>, respectively. For simplicity, we
    label the vertices <span class="tex2jax_process">$0, 1, 2,
    \dots , V-1$</span>.</p>
<p>The next <span class="tex2jax_process">$E$</span> lines
    describe the edges of <span class="tex2jax_process">$G$</span>,
    given in the format of an <i class="itshape">edge list</i>. In
    particular, the <span class="tex2jax_process">$i^\text
    {th}$</span> of these lines contains two integers <span class="tex2jax_process">$A_ i$</span> and <span class="tex2jax_process">$B_ i$</span> (<span class="tex2jax_process">$0\leq A_ i, B_ i &lt; V$</span>;
    <span class="tex2jax_process">$A_ i \neq B_ i$</span>),
    denoting that the <span class="tex2jax_process">$i^\text
    {th}$</span> edge connects vertex <span class="tex2jax_process">$A_ i$</span> to vertex <span class="tex2jax_process">$B_ i$</span>. It is guaranteed that for any
    pair of vertices <span class="tex2jax_process">$(a, b)$</span>,
    there is at most one edge from <span class="tex2jax_process">$a$</span> to <span class="tex2jax_process">$b$</span>.</p>
<p>The next <span class="tex2jax_process">$Q$</span> lines
    contain the queries. In particular, the <span class="tex2jax_process">$i^\text {th}$</span> of these lines begins
    with a single integer:</p>
<ul class="itemize">
<li>
<p>If this integer is <span class="tex2jax_process">$1$</span>, no integers follow.</p>
<dl class="description">
<dd>
<p>You should add a new vertex labeled <span class="tex2jax_process">$V$</span> to <span class="tex2jax_process">$G$</span>. This vertex should not
            have edges to or from any other vertex. <span class="tex2jax_process">$V$</span> – the current size of
            <span class="tex2jax_process">$G$</span> – now
            increases by 1.</p>
</dd>
</dl>
</li>
<li>
<p>If this integer is <span class="tex2jax_process">$2$</span>, two integers <span class="tex2jax_process">$X_ i$</span> and <span class="tex2jax_process">$Y_ i$</span> (<span class="tex2jax_process">$0\leq X_ i, Y_ i &lt; V$</span>;
        <span class="tex2jax_process">$X_ i \neq Y_ i$</span>)
        follow.</p>
<dl class="description">
<dd>
<p>You should add a new directed edge connecting vertex
            <span class="tex2jax_process">$X_ i$</span> to vertex
            <span class="tex2jax_process">$Y_ i$</span> in
            <span class="tex2jax_process">$G$</span>. It is
            guaranteed that this edge does not currently exist.</p>
</dd>
</dl>
</li>
<li>
<p>If this integer is <span class="tex2jax_process">$3$</span>, a single integer <span class="tex2jax_process">$X_ i$</span> (<span class="tex2jax_process">$0\leq X_ i &lt; V$</span>) follows.</p>
<dl class="description">
<dd>
<p>You should delete all the incoming and outgoing
            edges of <span class="tex2jax_process">$X_ i$</span>
            from the graph <span class="tex2jax_process">$G$</span>.</p>
</dd>
</dl>
</li>
<li>
<p>If this integer is <span class="tex2jax_process">$4$</span>, two integers <span class="tex2jax_process">$X_ i$</span> and <span class="tex2jax_process">$Y_ i$</span> (<span class="tex2jax_process">$0\leq X_ i, Y_ i &lt; V$</span>;
        <span class="tex2jax_process">$X_ i \neq Y_ i$</span>)
        follow.</p>
<dl class="description">
<dd>
<p>You should remove the directed edge connecting
            vertex <span class="tex2jax_process">$X_ i$</span> to
            vertex <span class="tex2jax_process">$Y_ i$</span> from
            <span class="tex2jax_process">$G$</span>. It is
            guaranteed that this edge currently exists.</p>
</dd>
</dl>
</li>
<li>
<p>If this integer is <span class="tex2jax_process">$5$</span>, no integers follow.</p>
<dl class="description">
<dd>
<p>You should replace <span class="tex2jax_process">$G$</span> with its transpose
            <span class="tex2jax_process">$G’$</span>, defined as
            follows:<br/>
            For every pair of vertices <span class="tex2jax_process">$(a, b)$</span>, the edge from
            <span class="tex2jax_process">$a$</span> to
            <span class="tex2jax_process">$b$</span> exists in
            <span class="tex2jax_process">$G’$</span> if and only
            <span class="tex2jax_process">$a \neq b$</span> and the
            edge from <span class="tex2jax_process">$b$</span> to
            <span class="tex2jax_process">$a$</span> exists in
            <span class="tex2jax_process">$G$</span>.</p>
</dd>
</dl>
</li>
<li>
<p>If this integer is <span class="tex2jax_process">$6$</span>, no integers follow.</p>
<dl class="description">
<dd>
<p>You should replace <span class="tex2jax_process">$G$</span> with its complement
            <span class="tex2jax_process">$\bar{G}$</span>, defined
            as follows:<br/>
            For every pair of vertices <span class="tex2jax_process">$(a, b)$</span>, the edge from
            <span class="tex2jax_process">$a$</span> to
            <span class="tex2jax_process">$b$</span> exists in
            <span class="tex2jax_process">$\bar{G}$</span> if and
            only <span class="tex2jax_process">$a \neq b$</span>
            and the edge from <span class="tex2jax_process">$a$</span> to <span class="tex2jax_process">$b$</span> does not exist in
            <span class="tex2jax_process">$G$</span>.</p>
</dd>
</dl>
</li>
</ul>
<h2>Output</h2>
<p>After performing all the queries, you will have a final
    graph <span class="tex2jax_process">$G$</span>. Since this
    graph can be very large, we will not ask you to output the
    entire graph. Instead, by doing the below, you can convince us
    that you indeed have the required graph.</p>
<ol class="enumerate">
<li>
<p>On the first line, output a single integer <span class="tex2jax_process">$V$</span>, the number of vertices in the
        graph <span class="tex2jax_process">$G$</span>.</p>
</li>
<li>
<p>For each of the next <span class="tex2jax_process">$V$</span> lines, output two integers. In
        particular, in the <span class="tex2jax_process">$i^\text
        {th}$</span> of these lines, output:</p>
<ul class="itemize">
<li>
<p><span class="tex2jax_process">$d_ i$</span>, the
            outdegree of vertex <span class="tex2jax_process">$i$</span>, and</p>
</li>
<li>
<p><span class="tex2jax_process">$h_ i$</span>, the
            <i class="itshape">hash</i> of the <i class="itshape">adjacency list</i> of vertex <span class="tex2jax_process">$i$</span>, defined as follows.
            Suppose the vertices in the out-neighborhood of vertex
            <span class="tex2jax_process">$i$</span> are
            <span class="tex2jax_process">$n_1 &lt; n_2 &lt; \dots
            &lt; n_{d_ i}$</span>. Then</p><span class="tex2jax_process">\begin{equation*} h_ i = 7^0\cdot n_1
            + 7^1\cdot n_2 + 7^2\cdot n_3 + \dots + 7^{d_ i-1}\cdot
            n_{d_ i} \end{equation*}</span>
<p>Since <span class="tex2jax_process">$h_ i$</span>
            can be quite large, you should output only the
            remainder after dividing this number by <span class="tex2jax_process">$10^9+7$</span>.</p>
</li>
</ul>
</li>
</ol>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>3 2 8
0 1
0 2
2 1 2
1
2 3 0
4 0 2
3 0
2 0 3
6
5
</pre>
</td>
<td>
<pre>4
3 162
3 161
2 21
2 15
</pre>
</td>
</tr>
</table>
</div>