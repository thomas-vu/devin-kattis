<div class="problembody">
<p>A water company is trying to provide water from its pumping
    station to a mansion. The company owns <span class="tex2jax_process">$n$</span> water stations, numbered
    <span class="tex2jax_process">$1 \ldots n$</span>, which are
    connected by a variety of pipes. Water can flow through both
    directions of a pipe, but the total amount of water that can
    flow through the pipe is bounded by the capacity of the
    pipe.</p>
<p>The water company is constantly improving the pipes,
    increasing the capacity of various pipes. The water company is
    conducting <span class="tex2jax_process">$k$</span>
    improvements (each of which is permanent after it is executed).
    An improvement consists of taking a pipe between two locations
    and increasing its capacity by a fixed amount, or installing a
    pipe between two locations which are not directly connected by
    a pipe.</p>
<p>After each improvement, the water company wants to know the
    maximum amount of water the mansion could receive.</p>
<h2>Input</h2>
<p>Each input will consist of a single test case. Note that
    your program may be run multiple times on different inputs. The
    first line of input contains three integers, <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$2
    \le n \le 100$</span>), <span class="tex2jax_process">$p$</span> (<span class="tex2jax_process">$0
    \le p \le \frac{n (n-1)}{2}$</span>), and <span class="tex2jax_process">$k$</span> (<span class="tex2jax_process">$1
    \le k \le 10\, 000$</span>), where <span class="tex2jax_process">$n$</span> is the number of stations,
    <span class="tex2jax_process">$p$</span> is the number of
    initial pipes, and <span class="tex2jax_process">$k$</span> is
    the number of improvements. The first station in the list is
    always the pumping station, and the second is always the
    mansion.</p>
<p>The next <span class="tex2jax_process">$p$</span> lines will
    describe the pipes in the initial setup. The lines will each
    contain three integers, <span class="tex2jax_process">$a$</span>, <span class="tex2jax_process">$b$</span> (<span class="tex2jax_process">$1
    \le a &lt; b \le n$</span>) and <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">$1
    \le c \le 1\, 000$</span>), which indicates that stations
    <span class="tex2jax_process">$a$</span> and <span class="tex2jax_process">$b$</span> are connected by a pipe with
    capacity <span class="tex2jax_process">$c$</span>. No
    <span class="tex2jax_process">$(a, b)$</span> pair will appear
    more than once in this section.</p>
<p>The next <span class="tex2jax_process">$k$</span> lines will
    describe the improvements. The lines will each contain three
    integers, <span class="tex2jax_process">$a$</span>,
    <span class="tex2jax_process">$b$</span> (<span class="tex2jax_process">$1 \le a &lt; b \le n$</span>) and
    <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">$1 \le c \le 1\, 000$</span>), which
    indicates that the pipe connecting stations <span class="tex2jax_process">$a$</span> and <span class="tex2jax_process">$b$</span> has its capacity increased by
    <span class="tex2jax_process">$c$</span> (if there is currently
    no pipe between <span class="tex2jax_process">$a$</span> and
    <span class="tex2jax_process">$b$</span>, then one is created
    with capacity <span class="tex2jax_process">$c$</span>). Note
    that it is possible for an <span class="tex2jax_process">$(a,b)$</span> pair to be repeated in this
    section.</p>
<h2>Output</h2>
<p>Output <span class="tex2jax_process">$k+1$</span> integers,
    each on its own line, describing the maximum amount of water
    that can reach the mansion. The first number is the amount of
    water reaching the mansion in the initial configuration. The
    next <span class="tex2jax_process">$k$</span> numbers are the
    amounts of water reaching the mansion after each
    improvement.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>3 2 1
1 3 10
2 3 1
2 3 15
</pre>
</td>
<td>
<pre>1
10
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>6 10 2
1 3 2
1 4 6
1 5 1
3 5 8
4 5 7
2 4 3
2 5 4
2 6 1
5 6 9
3 6 5
2 6 9
1 6 3
</pre>
</td>
<td>
<pre>8
9
12
</pre>
</td>
</tr>
</table>
</div>