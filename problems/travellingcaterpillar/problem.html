<div class="problembody">
<div class="illustration" style="width:30.00%">
<img alt="/problems/travellingcaterpillar/file/statement/en/img-0001.jpg" class="illustration" src="/problems/travellingcaterpillar/file/statement/en/img-0001.jpg"/>
<div class="description">
        Traversing directly between leaves is both dangerous and
        illegal.<br/>
<a href="https://commons.wikimedia.org/w/index.php?curid=49756580">Picture</a>
        by Vengolis via Wikimedia Commons, CC BY-SA 4.0
      </div>
</div>
<p>Lilith is a hungry caterpillar! From her vantage point at
    the root of a tree, she has identified some leaves she wishes
    to munch before returning to the root. She wants to finish
    munching all of them as quickly as possible so that she will
    grow into a plump, buttery butterfly.</p>
<p>The tree Lilith occupies is a bit unusual. We can view it as
    a collection of nodes, where some of the nodes contain leaves
    that Lilith wishes to munch. Each branch connects exactly two
    nodes together. It is guaranteed that between every pair of
    nodes, there is precisely one way to travel from one to the
    other.</p>
<p>Given a description of the tree and which nodes have leaves
    that Lilith wishes to munch, can you help Lilith route her
    munching by minimizing the time she must travel?</p>
<div class="figure" id="a0000000004">
<center>
<img alt="\includegraphics[width=0.6\textwidth ]{tree.pdf}" src="/problems/travellingcaterpillar/file/statement/en/img-0002.png" style="width:60.00%"/>
<div class="caption">
<b>Figure 1</b>: Illustration of Sample Input
          <span class="tex2jax_process">$1$</span>. Lilith can
          munch the nodes at leaves <span class="tex2jax_process">$2, 3, 6$</span> and return to the root
          <span class="tex2jax_process">$0$</span> by following the
          following sequence of nodes: <span class="tex2jax_process">$0 \rightarrow 4 \rightarrow 6
          \rightarrow 4 \rightarrow 0 \rightarrow 1 \rightarrow 2
          \rightarrow 1 \rightarrow 3 \rightarrow 1 \rightarrow
          0$</span>. The total distance Lilith travels is the
          length of each branch she crossed in this sequence:
          <span class="tex2jax_process">$2+3+3+2+5+1+1+4+4+5 =
          30$</span>.
        </div>
</center>
</div>
<h2>Input</h2>
<p>The first line of input contains two integers <span class="tex2jax_process">$N$</span> (<span class="tex2jax_process">$1
    \leq N \leq 1000$</span>), which is the number of nodes in the
    tree, and <span class="tex2jax_process">$K$</span>
    (<span class="tex2jax_process">$1 \leq K \leq N$</span>), which
    is the number of leaves to be munched.</p>
<p>The next <span class="tex2jax_process">$N-1$</span> lines of
    input describe the branches (edges) of the tree. The
    <span class="tex2jax_process">$i$</span>th such line contains
    three integers <span class="tex2jax_process">$s_ i$</span>,
    <span class="tex2jax_process">$t_ i$</span> (<span class="tex2jax_process">$0 \le s_ i, t_ i &lt; N, s_ i \neq t_
    i$</span>), and <span class="tex2jax_process">$d_ i$</span>
    (<span class="tex2jax_process">$0 \le d_ i \le 10^6$</span>).
    This indicates there is a branch between node <span class="tex2jax_process">$s_ i$</span> and node <span class="tex2jax_process">$t_ i$</span> which takes <span class="tex2jax_process">$d_ i$</span> time to cross. Furthermore, if
    we view the tree as rooted at node <span class="tex2jax_process">$0$</span>, we have that <span class="tex2jax_process">$s_ i$</span> is the parent of <span class="tex2jax_process">$t_ i$</span> (i.e. <span class="tex2jax_process">$s_ i$</span> lies on the unique path from
    <span class="tex2jax_process">$0$</span> to <span class="tex2jax_process">$t_ i$</span>). Lilith always starts at the
    root node <span class="tex2jax_process">$0$</span>.</p>
<p>The last line of input contains <span class="tex2jax_process">$K$</span> distinct integers <span class="tex2jax_process">$a_1, \ldots , a_ K$</span> (<span class="tex2jax_process">$0 \leq a_ i &lt; N$</span>), which indicates
    the nodes containing leaves that Lilith wants to munch.</p>
<h2>Output</h2>
<p>Display the length of the shortest path along the branches
    of the tree, starting and ending at the root, which allows
    Lilith to eat all leaves.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>7 3
0 1 5
0 4 2
1 2 1
1 3 4
4 5 3
4 6 3
2 3 6
</pre>
</td>
<td>
<pre>30
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>6 3
0 1 5
1 2 5
2 3 42
2 4 347
2 5 612
3 4 5
</pre>
</td>
<td>
<pre>2022
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>3 2
0 1 0
0 2 21
1 2
</pre>
</td>
<td>
<pre>42
</pre>
</td>
</tr>
</table>
</div>