<div class="problembody">
<div class="illustration" style="width:35.00%">
<img alt="/problems/entirelyunsortedsequences/file/statement/en/img-0001.jpg" class="illustration" src="/problems/entirelyunsortedsequences/file/statement/en/img-0001.jpg"/>
<div class="description">
        Image by <a href="https://www.flickr.com/photos/warriorwoman531/8155059324/">
        Heather Paul</a>.
      </div>
</div>
<p>You have recently been promoted to lead scientist at NASA,
    the National Association for Sorting Algorithms.
    Congratulations! Your primary responsibility is testing the
    sorting algorithms that your team produces. Fortunately, NASA
    has a large budget this year, and you were able to buy some
    state-of-the-art integers you can use to test the sorting
    algorithms.</p>
<p>As the lead scientist, you are well aware that algorithms
    are tested by their behaviour on worst case inputs. So, to test
    sorting algorithms, you need sequences that are as unsorted as
    possible.</p>
<p>Given a sequence of numbers <span class="tex2jax_process">$(a_1,\ldots ,a_ n)$</span> we say that an
    element <span class="tex2jax_process">$a_ k$</span> is sorted
    if for all indices <span class="tex2jax_process">$j$</span>
    such that <span class="tex2jax_process">$j &gt; k$</span>,
    <span class="tex2jax_process">$a_ j \geq a_ k$</span> and for
    all indices <span class="tex2jax_process">$j$</span> such that
    <span class="tex2jax_process">$j &lt; k$</span>, <span class="tex2jax_process">$a_ j \leq a_ k$</span>. For example,
    in</p><span class="tex2jax_process">\[ (1, 3, 2, 3, 4, 6, 5, 5)
    \]</span>
<p>the sorted elements are the <span class="tex2jax_process">$1$</span>, the second occurrence of
    <span class="tex2jax_process">$3$</span>, and the <span class="tex2jax_process">$4$</span>. Note that a sequence is sorted if
    and only if all its elements are sorted. A sequence is called
    <em>entirely unsorted</em> if none of its elements are
    sorted.</p>
<p>Given a sequence of integers, what is the number of entirely
    unsorted sequences you can make by permuting its elements? Two
    sequences <span class="tex2jax_process">$(b_1, \dots , b_
    n)$</span> and <span class="tex2jax_process">$(c_1, \dots , c_
    n)$</span> are considered to be different if there is some
    index <span class="tex2jax_process">$i \in \left\{ 1, \dots , n
    \right\} $</span> for which <span class="tex2jax_process">$b_ i
    \neq c_ i$</span>. Because the number of permutations may be
    very large, please give it modulo <span class="tex2jax_process">$10^9 + 9$</span>.</p>
<h2>Input</h2>
<p>The input starts with an integer <span class="tex2jax_process">$1 \leq n \leq 5\, 000$</span>. Then follows
    a single line with <span class="tex2jax_process">$n$</span>
    integers <span class="tex2jax_process">$a_1, \ldots , a_
    n$</span>, with <span class="tex2jax_process">$0 \leq a_ i \leq
    10^9$</span> for all <span class="tex2jax_process">$i$</span>.</p>
<h2>Output</h2>
<p>Print a single integer: the number of entirely unsorted
    sequences you can make by permuting the <span class="tex2jax_process">$a_ i$</span>, modulo <span class="tex2jax_process">$10^9 + 9$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>4
0 1 2 3
</pre>
</td>
<td>
<pre>14
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>5
1 1 2 1 1
</pre>
</td>
<td>
<pre>1
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>13
1 2 3 4 5 6 7 8 9 10 11 12 13
</pre>
</td>
<td>
<pre>298600727
</pre>
</td>
</tr>
</table>
</div>