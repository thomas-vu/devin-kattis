<div class="problembody">
<div class="illustration" style="width:40.00%">
<img alt="/problems/busplanning/file/statement/en/img-0001.jpg" class="illustration" src="/problems/busplanning/file/statement/en/img-0001.jpg"/>
<div class="description">
<a href="https://commons.wikimedia.org/wiki/File:Chevrolet_Van_School_Bus.jpg">
        Picture</a> by AutoPhoto via Wikimedia Commons, cc by
      </div>
</div>An elementary school class is going on a road trip by bus
    to a computer factory. However, the driver is really tired of
    having to drive fighting kids all day, so she suggested that
    the class should split up and go to the factory in groups. She
    has already observed which kids dislike each other and are
    likely to fight, so she wants to make sure they do not end up
    in the same group. Of course, driving everyone one-by-one is a
    waste of time and money, so the driver wants to minimize the
    number of groups she has to drive. In addition, the bus is
    pretty small, and may only fit up to <span class="tex2jax_process">$c$</span> kids at a time.
    <p>You are to write a program which helps her with the task of
    making these groups. Given the number of kids and their
    enemies, find the minimum number of groups required, as well as
    a division of the class into this minimum number of groups</p>
<h2>Input</h2>
<p>The first line contains three integers <span class="tex2jax_process">$n$</span>, <span class="tex2jax_process">$k$</span>, and <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">$1
    \le n \le 17$</span>, <span class="tex2jax_process">$0 \le k
    \le \frac{n(n-1)}{2}$</span> and <span class="tex2jax_process">$1 \le c \le n$</span>) – the number of kids,
    pairs of enemies, and the capacity of the bus, respectively.
    Then follow <span class="tex2jax_process">$n$</span> lines with
    the kids’ names. Each name consists solely of the characters
    <tt class="ttfamily">A-Z</tt> and <tt class="ttfamily">a-z</tt>, is non-empty, and at most <span class="tex2jax_process">$10$</span> characters long. Then follow
    <span class="tex2jax_process">$k$</span> lines, each containing
    a pair of space-separated names indicating a pair of kids that
    dislike each other. No pair of names appears twice, and no kid
    is their own enemy.</p>
<h2>Output</h2>
<p>On the first line, output the minimum number of groups,
    followed by one line per group containing the names of the
    children in that group (separated by spaces).</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>2 0 1
Alice
Bob
</pre>
</td>
<td>
<pre>2
Alice
Bob
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>3 2 3
Alice
Charlie
Bob
Alice Charlie
Bob Charlie
</pre>
</td>
<td>
<pre>2
Alice Bob 
Charlie 
</pre>
</td>
</tr>
</table>
</div>