<div class="problembody">
<p>We want to create a smartphone application to help visitors
    of a shopping mall and you have to calculate the shortest path
    between pairs of locations in the mall. Given the current
    location of the visitor and his destination, the application
    will show the shortest walking path (in meters) to arrive to
    the destination.</p>
<p>The mall has <span class="tex2jax_process">$N$</span> places
    in several floors connected by walking paths, lifts, stairs and
    escalators (automated stairs). Note that the shortest path in
    meters may involve using an escalator in the opposite
    direction. We only want to count the distance that the visitor
    has walked so each type of movement between places has a
    different cost in meters:</p>
<ul class="itemize">
<li>
<p>If <em>walking</em> or taking the <em>stairs</em> the
        distance is the euclidean distance between the points.</p>
</li>
<li>
<p>Using the <em>lift</em> has a cost of 1 meter because
        once we enter the lift we do not walk at all. One lift can
        only connect 2 points. An actual lift connects the same
        point of different floors, in the map all the points
        connected by a lift have the corresponding edge. So you do
        not need to worry about that. For instance, if there are
        three floors and one lift at position <span class="tex2jax_process">$(1,2)$</span> of each floor, the input
        contains the edges <span class="tex2jax_process">$(0, 1, 2)
        \to (1, 1, 2)$</span>, <span class="tex2jax_process">$(1,
        1, 2) \to (2, 1, 2)$</span>, and <span class="tex2jax_process">$(0, 1, 2) \to (2, 1, 2)$</span>. In some
        maps it can be possible that a lift does not connect all
        the floors, then some of the edges will not be in the
        input.</p>
</li>
<li>
<p>The escalator has two uses:</p>
<ul class="itemize">
<li>
<p>Moving from <tt class="ttfamily">A</tt> to
            <tt class="ttfamily">B</tt> (proper direction) the cost
            is 1 meter because we only walk a few steps and then
            the escalator moves us.</p>
</li>
<li>
<p>Moving from <tt class="ttfamily">B</tt> to
            <tt class="ttfamily">A</tt> (opposite direction) has a
            cost of the euclidean distance between <tt class="ttfamily">B</tt> and <tt class="ttfamily">A</tt>
            multiplied by a factor of 3.</p>
</li>
</ul>
</li>
</ul>
<p>The shortest walking path must use only these connections.
    All the places are connected to each other by at least one
    path.</p>
<h2>Input</h2>
<p>Each input file contains the map of a unique shopping mall
    and a list of queries.</p>
<p>The first line contains two integers <span class="tex2jax_process">$N$</span> (<span class="tex2jax_process">$N
    \leq 200$</span>) and <span class="tex2jax_process">$M$</span>
    (<span class="tex2jax_process">$N - 1 \leq M \leq 1\,
    000$</span>), the number of places and connections
    respectively. The places are numbered from <span class="tex2jax_process">$0$</span> to <span class="tex2jax_process">$N-1$</span>. The next <span class="tex2jax_process">$N$</span> lines contain floor and the
    coordinates <span class="tex2jax_process">$x$</span>,
    <span class="tex2jax_process">$y$</span> of the places, one
    place per line. The distance between floors is 5 meters. The
    other two coordinates <span class="tex2jax_process">$x$</span>
    and <span class="tex2jax_process">$y$</span> are expressed in
    meters.</p>
<p>The next <span class="tex2jax_process">$M$</span> lines
    contain the direct connections between places. Each connection
    is defined by the identifier of both places and the type of
    movement (one of the following: <tt class="ttfamily">walking</tt>, <tt class="ttfamily">stairs</tt>,
    <tt class="ttfamily">lift</tt>, or <tt class="ttfamily">escalator</tt>). Check the cost of each type in the
    description above. The type for places in the same floor is
    <em>walking</em>.</p>
<p>The next line contains an integer <span class="tex2jax_process">$Q$</span> (<span class="tex2jax_process">$1
    \leq Q \leq 1\, 000$</span>) that represents the number of
    queries that follow. The next <span class="tex2jax_process">$Q$</span> lines contain two places each
    <tt class="ttfamily">a</tt> and <tt class="ttfamily">b</tt>. We
    want the shortest walking path distance to go from <tt class="ttfamily">a</tt> to <tt class="ttfamily">b</tt>.</p>
<h2>Output</h2>
<p>For each query write a line with the shortest path in walked
    meters from the origin to the destination, with each place
    separated by a space.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
6 7
3 2 3
3 5 3
2 2 3
2 6 4
1 1 3
1 4 2
0 1 walking
0 2 lift
1 2 stairs
2 3 walking
3 4 escalator
5 3 escalator
4 5 walking
5
0 1
1 2
3 5
5 3
5 1
</pre>
</td>
<td>
<pre>
0 1
1 0 2
3 4 5
5 3
5 3 2 0 1
</pre>
</td>
</tr>
</table>
</div>