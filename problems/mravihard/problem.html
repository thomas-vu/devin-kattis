<div class="problembody">
<p>Little Bobi gets up every morning and feeds his favourite
    pets: ants. He keeps them in a terrarium with a pipe system
    that can be represented as a tree with <span class="tex2jax_process">$N$</span> nodes. The pipes are represented
    by the edges of the tree. The root of the tree is located at
    node denoted with <span class="tex2jax_process">$1$</span>.
    Inside the pipe system, the liquid <em>flows from a node to its
    children</em> because of gravity.</p>
<p>We know the flow <span class="tex2jax_process">$X_ i$</span>
    of each pipe: the percent of fluid from the parent node that
    flows through that pipe to the child node. Let’s observe the
    following example:</p>
<div class="figure" id="a0000000004">
<center>
<img alt="\includegraphics[width=0.2\textwidth ]{img}" src="/problems/mravihard/file/statement/en/img-0001.png" style="width:20.00%"/>
<div class="caption">
<b>Figure 1</b>: Example
        </div>
</center>
</div>
<p>Node <span class="tex2jax_process">$1$</span> from the image
    has <span class="tex2jax_process">$12$</span> liters of liquid
    in it and has two pipes after it. One has the flow of
    <span class="tex2jax_process">$X_ i = 30$</span>, and the other
    <span class="tex2jax_process">$X_ i = 70$</span>. Node
    <span class="tex2jax_process">$2$</span> is going to get
    <span class="tex2jax_process">$3.6$</span> liters and node
    <span class="tex2jax_process">$3$</span> gets <span class="tex2jax_process">$8.4$</span> liters. In the input data, the
    sum of flows of pipes going from the same node will always be
    equal to <span class="tex2jax_process">$100$</span>.</p>
<p>Some of Bobi’s pipes aren’t just regular pipes; they are a
    bit strange. They are super pipes that have the superpower to
    <em>square the amount</em> of liquid flowing through them. In
    the previous example, if the first pipe has the superpower,
    node <span class="tex2jax_process">$2$</span> gets <span class="tex2jax_process">$12.96$</span> liters and node <span class="tex2jax_process">$3$</span> still gets only <span class="tex2jax_process">$8.4$</span> liters. Notice now that a node
    has more liquid leaving it than the amount entering it. This is
    exactly the reason why these pipes are super pipes!</p>
<p>All super pipes can have their superpower turned on or off
    by Bobi.</p>
<p>The ants live only in the leaves of the tree (nodes that
    don’t have any children). For each leaf we know the required
    amount of liquid <span class="tex2jax_process">$K_ i$</span> to
    feed all ants living in that leaf. Bobi wants to feed his ants
    by pouring <span class="tex2jax_process">$L$</span> liters of
    liquid into the root of the tree. He doesn’t have much money so
    he wants to know the minimum amount of liters of liquid he
    needs to buy to keep all of his ants fed.</p>
<p>Please note: The input data is such that the required number
    <span class="tex2jax_process">$L$</span> will not exceed
    <span class="tex2jax_process">$2 \cdot 10^9$</span>.</p>
<h2>Input</h2>
<p>The first line of input contains the integer <span class="tex2jax_process">$N$</span> (<span class="tex2jax_process">$1
    \leq N \leq 1\, 000$</span>).</p>
<p>Each of the following <span class="tex2jax_process">$N -
    1$</span> lines contain four integers <span class="tex2jax_process">$A_ i$</span>, <span class="tex2jax_process">$B_ i$</span>, <span class="tex2jax_process">$X_ i$</span>, <span class="tex2jax_process">$T_ i$</span> (<span class="tex2jax_process">$1 \leq A_ i, B_ i \leq N$</span>,
    <span class="tex2jax_process">$1 \leq X_ i \leq 100$</span>,
    <span class="tex2jax_process">$0 \leq T_ i \leq 1$</span>)
    where <span class="tex2jax_process">$A_ i$</span> and
    <span class="tex2jax_process">$B_ i$</span> are the ends of a
    pipe (the labels of nodes connected by the pipe), <span class="tex2jax_process">$X_ i$</span> is the flow of the liquid
    through the pipe, and <span class="tex2jax_process">$T_
    i$</span> denotes whether the pipe has a superpower. If
    <span class="tex2jax_process">$T_ i$</span> is <span class="tex2jax_process">$1$</span>, that pipe has a superpower,
    otherwise it does not.</p>
<p>The following line contains <span class="tex2jax_process">$N$</span> real numbers <span class="tex2jax_process">$K_ i$</span> describing the amount of liquid
    needed for the ants in the <span class="tex2jax_process">$i$</span>-th node. If the <span class="tex2jax_process">$i$</span>-th node is not a leaf,
    <span class="tex2jax_process">$K_ i$</span> will be
    <span class="tex2jax_process">$-1$</span>, otherwise it will be
    a number from the interval <span class="tex2jax_process">$[0.1,
    10]$</span>.</p>
<h2>Output</h2>
<p>The first and only line of output must contain the required
    number from the task. Please note: The allowed absolute error
    from the correct (precise) solution is <span class="tex2jax_process">$0.001$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
5
1 2 50 0
1 3 50 0
2 4 25 0
2 5 75 1
-1 -1 4.0 1.0 9.0
</pre>
</td>
<td>
<pre>
8.00
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
3
1 2 20 1
1 3 80 1
-1 4.0 8.0
</pre>
</td>
<td>
<pre>
10.0000
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>
6
1 2 100 1
2 3 20 0
2 4 20 0
2 5 60 0
4 6 100 1
-1 -1 1.0 -1 1.0 2.0
</pre>
</td>
<td>
<pre>
2.659
</pre>
</td>
</tr>
</table>
</div>