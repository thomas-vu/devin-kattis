<div class="problembody">
<p>“Oh no, they’ve done it again”, cries the chief designer at
    the Waferland chip factory. Once more the routing designers
    have screwed up completely, making the signals on the chip
    connecting the ports of two functional blocks cross each other
    all over the place. At this late stage of the process, it is
    too expensive to redo the routing. Instead, the engineers have
    to bridge the signals, using the third dimension, so that no
    two signals cross. However, bridging is a complicated
    operation, and thus it is desirable to bridge as few signals as
    possible. The call for a computer program that finds the
    maximum number of signals which may be connected on the silicon
    surface without crossing each other, is imminent. Bearing in
    mind that there may be thousands of signal ports at the
    boundary of a functional block, the problem asks quite a lot of
    the programmer. Are you up to the task?</p>
<div class="figure" id="fig:signals">
<center>
<p><img alt="\includegraphics[width=0.7\textwidth ]{signals}" src="/problems/signals/file/statement/en/img-0001.png" style="width:70.00%"/></p>
<div class="caption">
<b>Figure 1</b>: To the left: The two blocks’ ports and
          their signal mapping <span class="tex2jax_process">$(4,2,6,3,1,5)$</span>. To the right:
          At most three signals may be routed on the silicon
          surface without crossing each other. The dashed signals
          must be bridged.
        </div>
</center>
</div>
<p>A typical situation is schematically depicted in
    Figure 1. The ports of the two functional blocks are
    numbered from <span class="tex2jax_process">$1$</span> to
    <span class="tex2jax_process">$p$</span>, from top to bottom.
    The signal mapping is described by a permutation of the numbers
    <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$p$</span> in the form of a list of
    <span class="tex2jax_process">$p$</span> unique numbers in the
    range <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$p$</span>, in which the <span class="tex2jax_process">$i$</span>’th number specifies which port on
    the right side should be connected to the <span class="tex2jax_process">$i$</span>’th port on the left side. Two
    signals cross if and only if the straight lines connecting the
    two ports of each pair do.</p>
<h2>Input</h2>
<p>Input begins with a line containing a single positive
    integer <span class="tex2jax_process">$p \le 500\, 000$</span>,
    the number of ports on the two functional blocks. Then follow
    <span class="tex2jax_process">$p$</span> lines, describing the
    signal mapping: on the <span class="tex2jax_process">$i$</span>’th line is the port number of the
    block on the right side which should be connected to the
    <span class="tex2jax_process">$i$</span>’th port of the block
    on the left side.</p>
<h2>Output</h2>
<p>Output one line containing the maximum number of signals
    which may be routed on the silicon surface without crossing
    each other.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>6
4
2
6
3
1
5
</pre>
</td>
<td>
<pre>3
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>10
2
3
4
5
6
7
8
9
10
1
</pre>
</td>
<td>
<pre>9
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>8
8
7
6
5
4
3
2
1
</pre>
</td>
<td>
<pre>1
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 4</th>
<th>Sample Output 4</th>
</tr>
<tr>
<td>
<pre>9
5
8
9
2
3
1
7
4
6
</pre>
</td>
<td>
<pre>4
</pre>
</td>
</tr>
</table>
</div>