<div class="problembody">
<center>
<p><span style="float:right"><img alt="\includegraphics[width=0.42\textwidth ]{floweryTrail.jpg}" src="/problems/flowerytrails/file/statement/en/img-0001.jpg" style="width:42.00%"/></span></p>
<p><span style="float:right"><img alt="\includegraphics[width=0.42\textwidth ]{map.jpg}" src="/problems/flowerytrails/file/statement/en/img-0002.jpg" style="width:42.00%"/></span></p>
</center>
<p>In order to attract more visitors, the manager of a national
    park had the idea of planting flowers along both sides of the
    <i class="itshape">popular trails</i>, which are the trails
    used by <i class="itshape">common people</i>. <i class="itshape">Common people</i> only go from the park entrance to
    its highest peak, where views are breathtaking, by a shortest
    path. So, he wants to know how many metres of flowers are
    needed to materialize his idea.</p>
<p>For instance, in the park whose map is depicted in the
    figure, common people make only one of the three following
    paths (which are the shortest paths from the entrance to the
    highest peak).</p>
<ul class="itemize">
<li>
<p>At the entrance, some start in the rightmost trail to
        reach the point of interest 3 (after 100 metres), follow
        directly to point 7 (200 metres) and then pick the direct
        trail to the highest peak (620 metres).</p>
</li>
<li>
<p>The others go to the left at the entrance and reach
        point 1 (after 580 metres). Then, they take one of the two
        trails that lead to point 4 (both have 90 metres). At point
        4, they follow the direct trail to the highest peak (250
        metres).</p>
</li>
</ul>
<p>Notice that popular trails (i.e., the trails followed by
    common people) are highlighted in yellow. Since the sum of
    their lengths is 1930 metres, the extent of flowers needed to
    cover both sides of the popular trails is 3860 metres
    (<span class="tex2jax_process">$3860 = 2 \times
    1930$</span>).</p>
<h3>Task</h3>
<p>Given a description of the park, with its points of interest
    and (two-way) trails, the goal is to find out the extent of
    flowers needed to cover both sides of the popular trails. It is
    guaranteed that, for the given inputs, there is some path from
    the park entrance to the highest peak.</p>
<h3>Input</h3>
<p>The first line of the input has two integers: <span class="tex2jax_process">$P$</span> and <span class="tex2jax_process">$T$</span>. <span class="tex2jax_process">$P$</span> is the number of points of
    interest and <span class="tex2jax_process">$T$</span> is the
    number of trails. Points are identified by integers, ranging
    from 0 to <span class="tex2jax_process">$P-1$</span>. The
    entrance point is 0 and the highest peak is point <span class="tex2jax_process">$P-1$</span>.</p>
<p>Each of the following <span class="tex2jax_process">$T$</span> lines characterises a different
    trail. It contains three integers, <span class="tex2jax_process">$p_1$</span>, <span class="tex2jax_process">$p_2$</span>, and <span class="tex2jax_process">$l$</span>, which indicate that the (two-way)
    trail links directly points <span class="tex2jax_process">$p_1$</span> and <span class="tex2jax_process">$p_2$</span> (not necessarily distinct) and
    has length <span class="tex2jax_process">$l$</span> (in
    metres).</p>
<p>Integers in the same line are separated by a single
    space.</p>
<h3>Constraints</h3>
<table cellspacing="0" class="tabular">
<tr>
<td style="text-align:left">
<p><span class="tex2jax_process">$2 \leq P \leq 10\,
          000$</span></p>
</td>
<td style="text-align:left">
<p>Number of points.</p>
</td>
</tr>
<tr>
<td style="text-align:left">
<p><span class="tex2jax_process">$1 \leq T \leq 250\,
          000$</span></p>
</td>
<td style="text-align:left">
<p>Number of trails.</p>
</td>
</tr>
<tr>
<td style="text-align:left">
<p><span class="tex2jax_process">$1 \leq l \leq 1\,
          000$</span></p>
</td>
<td style="text-align:left">
<p>Length of a trail.</p>
</td>
</tr>
</table>
<h3>Output</h3>
<p>The output has a single line with the extent of flowers (in
    metres) needed to cover both sides of the popular trails.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
10 15
0 1 580
1 4 90
1 4 90
4 9 250
4 2 510
2 7 600
7 3 200
3 3 380
3 0 150
0 3 100
7 8 500
7 9 620
9 6 510
6 5 145
5 9 160
</pre>
</td>
<td>
<pre>
3860
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
4 7
0 1 1
0 2 2
0 3 10
0 3 3
1 3 2
2 3 1
1 1 1
</pre>
</td>
<td>
<pre>
18
</pre>
</td>
</tr>
</table>
</div>