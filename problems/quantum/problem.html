<div class="problembody">
<p>At the Institution for Bits and Bytes at University of
    Ramville, Prof. Jeremy Longword and his eight graduate students
    are investigating a brand new way of storing and manipulating
    data on magnetic disks for use in hard drives. The method is
    based on letting quasimagnetic quantum operations operate on
    the sectors on the disk, and is, of course, safer and more
    reliable than any earlier invented storage method. The use of
    each quantum operation costs a certain amount of energy, and
    the more energy the storage unit consumes, the warmer it will
    get. Therefore, you and your research team, are assigned the
    task of writing a program that, given sets of possible quantum
    operations and their costs, can calculate the lowest possible
    total cost for transforming a set of data to the wanted
    result.</p>
<p>On the disk, binary words of length <span class="tex2jax_process">$1\leq L\leq 20$</span> are treated. The
    quantum operations are defined by strings of the same length as
    the binary words, and are built from the four letters N (does
    nothing), F (inverts one bit), S (sets a bit to 1), and C
    (resets a bit to 0). Each letter in the string corresponds to
    an operation on the bit in the binary word at the same
    position. The binary words are transformed one by one and the
    total energy cost for the transformation is calculated as the
    sum of the costs for the performed quantum operations.</p>
<h2>Input</h2>
<p>The input starts with a single positive integer <span class="tex2jax_process">$N \leq 20$</span> on a row, deciding the
    number of test cases that will follow. Then, for each of the
    test cases:</p>
<ul class="itemize">
<li>
<p>One line containing three integers: <span class="tex2jax_process">$L$</span>, <span class="tex2jax_process">$n_{op}$</span> and <span class="tex2jax_process">$n_ w$</span> separated by one space.</p>
</li>
<li>
<p><span class="tex2jax_process">$L$</span> indicates the
        length of the binary words and the quantum operations.</p>
</li>
<li>
<p><span class="tex2jax_process">$n_{op} (\leq 32)$</span>
        is the number of quantum operations that are available for
        use when transforming the binary words.</p>
</li>
<li>
<p><span class="tex2jax_process">$n_ w (\leq 20)$</span> is
        the number of binary words that are to be transformed in
        the current test case.</p>
</li>
</ul>
<p>After this, <span class="tex2jax_process">$n_{op}$</span>
    rows follows, each of them containing the definition of a
    quantum operation followed by the energy cost <span class="tex2jax_process">$0\leq c_ i \leq 1000$</span> of carrying out
    the quantum operation. The definition and the cost are
    separated by a single space.</p>
<p>Finally, there are <span class="tex2jax_process">$n_
    w$</span> rows, each containing two binary words separated by a
    single space. The first of these words should, when possible,
    be transformed to the second using the quantum operations. The
    binary words are expressed as sequences of 1’s and 0’s. After
    these rows, the next test case follows, if there is any.</p>
<h2>Output</h2>
<p>Each test case should produce a row containing a list of the
    energy costs of transforming each of the binary words. The
    costs should be separated by a single space and presented in
    the same order as the corresponding input. When there is no
    successful way of transforming a binary word, “<tt class="tt">NP</tt>” (meaning <em>not possible</em>) should be printed
    instead.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
2
4 3 3
NFFN 1
NFNF 2
NNFN 4
0010 0100
0001 0010
0100 1000
4 4 5
CFSF 4
NNSS 3
FFFF 5
FNFN 6
1111 0000
1001 0110
0101 1000
1000 0011
0000 1001
</pre>
</td>
<td>
<pre>
1 3 NP
5 4 8 9 9
</pre>
</td>
</tr>
</table>
</div>