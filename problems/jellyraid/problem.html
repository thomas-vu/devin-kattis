<div class="problembody">
<p>The full-board residents of the famous but misnamed
    Adephagia School For Boys feel hard done by. Recent savings
    have seen dinnertime puddings cut back to a single biscuit
    while the masters finish their meals with fine raspberry jelly
    every night. Although the choice of custard cream or bourbon is
    not a bad one, the children hunger for the raspberry-filled
    delight and have planned a midnight raid.</p>
<p>A child must make it from their dorm, across the school to
    the kitchen without being seen by the patrolling masters. In
    any turn a child can stand still, or move to a horizontally or
    vertically neighbouring cell. Each turn the patrolling masters
    will move a step along their route. When they reach the end of
    their route, they will turn and continue to retrace their steps
    indefinitely. A child will be caught if the child and a master
    are on the same row or column with no blocked area between
    them.</p>
<p>If the child can make it to the fridge in the kitchen
    unseen, we recognise they can either make it back to their bed
    unseen or get caught fully of jelly and not care. See the first
    example, where the child can reach the fridge after
    <span class="tex2jax_process">$26$</span> turns, even though it
    gets spotted at that same time.</p>
<h2>Input</h2>
<ul class="itemize">
<li>
<p>One line consisting of two positive integers
        <span class="tex2jax_process">$r$</span> <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">$1 &lt; r, c \leq 60$</span>), the size
        of the school in rows and columns.</p>
</li>
<li>
<p>One line consisting of two pairs of bracketed positive
        integers, the row and column coordinates of the starting
        bed in the dormitory and the fridge in the kitchen
        respectively.</p>
</li>
<li>
<p>Another <span class="tex2jax_process">$r$</span> lines,
        each containing a string of <span class="tex2jax_process">$c$</span> characters with the following
        meaning:</p>
<ul class="itemize">
<li>
<p>‘<tt class="ttfamily">.</tt>’: Walkable area</p>
</li>
<li>
<p>‘<tt class="ttfamily">#</tt>’: Blocked area</p>
</li>
</ul>
</li>
<li>
<p>One line consisting of a single integer <span class="tex2jax_process">$p$</span> (<span class="tex2jax_process">$1 \le p \le 200$</span>) representing
        the number of patrolling masters.</p>
</li>
<li>
<p>Another <span class="tex2jax_process">$p$</span> lines,
        each a size-prefixed list of between <span class="tex2jax_process">$1$</span> and <span class="tex2jax_process">$7$</span> space-separated bracketed
        <span class="tex2jax_process">$(r, c)$</span> coordinates
        representing a contiguous path for the master to
        patrol.</p>
</li>
</ul>
<p>All ‘special’ coordinates (locations of the bed, fridge, and
    masters) will be marked as walkable on the map.</p>
<h2>Output</h2>
<p>On a single line print the minimum number of turns for the
    child to reach the jelly. If the child cannot reach the jelly,
    output <tt class="ttfamily">IMPOSSIBLE</tt>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
5 5
(2 5) (5 3)
.....
.#.#.
.#.#.
....#
.#.##
1
6 (4 2) (4 3) (3 3) (2 3) (1 3) (1 2)
</pre>
</td>
<td>
<pre>
26
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
5 4
(1 4) (5 4)
....
..#.
###.
....
###.
2
2 (2 2) (2 1)
4 (4 1) (4 2) (4 3) (4 3)
</pre>
</td>
<td>
<pre>
IMPOSSIBLE
</pre>
</td>
</tr>
</table>
</div>