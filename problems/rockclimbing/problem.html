<div class="problembody">
<div class="illustration" style="width:45.00%">
<img alt="/problems/rockclimbing/file/statement/en/img-0001.jpg" class="illustration" src="/problems/rockclimbing/file/statement/en/img-0001.jpg"/>
<div class="description"></div>
</div>
<p>Peter is attempting to deep-water solo a rock climbing cliff
    over the ocean. Deep-water soloing (DWS) is a form of solo rock
    climbing that relies solely upon the presence of water at the
    base of the climb to protect against injury from falling.</p>
<p>Rock climbing is very exhausting and takes lots of energy.
    Since Peter is not very flexible, he can only move <span class="tex2jax_process">$1$</span> unit in any of the four
    directions: Up, Down, Left, and Right. Traveling to a different
    square will decrease Peter’s energy by the amount on that
    square. Note that the amount of energy on a square can be
    negative. In this case, Peter will gain energy.</p>
<p>If Peter’s energy is negative, he will fall into the
    water.</p>
<p>Peter doesn’t want to get wet, so he asks you to compute the
    minimum amount of energy he needs to complete the climb,
    assuming he takes an optimal route.</p>
<h2>Input</h2>
<p>The first line of the input will contain two integers,
    <span class="tex2jax_process">$R$</span>, <span class="tex2jax_process">$C$</span> (<span class="tex2jax_process">$1
    \leq R, C \leq 15$</span>). The second line of input will
    consist of a row of <span class="tex2jax_process">$C$</span>
<tt class="ttfamily">E</tt> characters, separated by spaces,
    representing the top of the cliff. These take <span class="tex2jax_process">$0$</span> units of energy to enter. Peter
    can choose any of them.</p>
<p>Next, there will be <span class="tex2jax_process">$R$</span>
    rows of <span class="tex2jax_process">$C$</span> columns of
    numbers <span class="tex2jax_process">$X_{r,c}$</span>, where
    (<span class="tex2jax_process">$-9 \leq X_{r,c} \leq
    9$</span>), the energy required to enter that section of cliff.
    The final line of input will consist of a row of <span class="tex2jax_process">$C$</span> <tt class="ttfamily">S</tt>
    characters, representing the possible start points of the
    climb. These take <span class="tex2jax_process">$0$</span>
    units of energy to enter. Peter may return to any field,
    including the starting position, as often as he likes.</p>
<h2>Output</h2>
<p>Output a single integer, the minimum initial amount of
    energy necessary to complete the climb without falling.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
5 5
E E E E E
1 2 3 4 5
5 4 3 2 1
-2 -2 -2 -2 -2
8 8 8 8 8
9 9 9 9 9
S S S S S
</pre>
</td>
<td>
<pre>
17
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
13 5
E E E E E
1 1 1 1 1
1 1 1 2 1
9 9 9 9 1
1 1 1 9 1
1 9 1 1 1
1 9 9 9 9
1 2 3 4 5
2 3 4 5 6
3 4 5 6 7
4 5 6 7 8
9 6 7 8 9
-5 9 -7 9 -5
6 0 7 0 5
S S S S S
</pre>
</td>
<td>
<pre>
32
</pre>
</td>
</tr>
</table>
</div>