<div class="problembody">
<p>You are in charge of designing an advanced centralized
    traffic management system for smart cars. The goal is to use
    global information to instruct morning commuters, who must
    drive downtown from the suburbs, how best to get to the city
    center while avoiding traffic jams.</p>
<p>Unfortunately, since commuters know the city and are
    selfish, you cannot simply tell them to travel routes that take
    longer than normal (otherwise they will just ignore your
    directions). You can only convince them to change to different
    routes that are equally fast.</p>
<p>The city’s network of roads consists of intersections that
    are connected by bidirectional roads of various travel times.
    Each commuter starts at some intersection, which may vary from
    commuter to commuter. All commuters end their journeys at the
    same place, which is downtown at intersection 1. If two
    commuters attempt to start travelling along the same road in
    the same direction at the same time, there will be congestion;
    you must avoid this. However, it is fine if two commuters pass
    through the same intersection simultaneously or if they take
    the same road starting at different times.</p>
<p>Determine the maximum number of commuters who can drive
    downtown without congestion, subject to all commuters starting
    their journeys at exactly the same time and without any of them
    taking a suboptimal route.</p>
<div class="figure" id="fig:congest">
<center>
<img alt="\includegraphics[width=0.4\textwidth ]{sample}" src="/problems/congest/file/statement/en/img-0001.png" style="width:40.00%"/>
<div class="caption">
<b>Figure 1</b>: Illustration of Sample Input 2.
        </div>
</center>
</div>
<p>In Figure 1, cars are shown in their original
    locations. One car is already downtown. Of the cars at
    intersection 4, one can go along the dotted route through
    intersection 3, and another along the dashed route through
    intersection 2. But the remaining two cars cannot reach
    downtown while avoiding congestion. So a maximum of 3 cars can
    reach downtown with no congestion.</p>
<h2>Input</h2>
<p>The input consists of a single test case. The first line
    contains three integers <span class="tex2jax_process">$n$</span>, <span class="tex2jax_process">$m$</span>, and <span class="tex2jax_process">$c$</span>, where <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$1
    \le n \le 25\, 000$</span>) is the number of intersections,
    <span class="tex2jax_process">$m$</span> (<span class="tex2jax_process">$0 \le m \le 50\, 000$</span>) is the number
    of roads, and <span class="tex2jax_process">$c$</span>
    (<span class="tex2jax_process">$0 \le c \le 1\, 000$</span>) is
    the number of commuters. Each of the next <span class="tex2jax_process">$m$</span> lines contains three integers
    <span class="tex2jax_process">$x_ i$</span>, <span class="tex2jax_process">$y_ i$</span>, and <span class="tex2jax_process">$t_ i$</span> describing one road, where
    <span class="tex2jax_process">$x_ i$</span> and <span class="tex2jax_process">$y_ i$</span> (<span class="tex2jax_process">$1 \le x_ i, y_ i \le n$</span>) are the
    distinct intersections the road connects, and <span class="tex2jax_process">$t_ i$</span> (<span class="tex2jax_process">$1 \le t_ i \le 10\, 000$</span>) is the time
    it takes to travel along that road in either direction. You may
    assume that downtown is reachable from every intersection. The
    last line contains <span class="tex2jax_process">$c$</span>
    integers listing the starting intersections of the
    commuters.</p>
<h2>Output</h2>
<p>Display the maximum number of commuters who can reach
    downtown without congestion.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
3 3 2
1 2 42
2 3 1
2 3 1
2 3
</pre>
</td>
<td>
<pre>
2
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
4 4 5
1 2 5
1 3 4
4 2 5
4 3 6
4 4 4 4 1
</pre>
</td>
<td>
<pre>
3
</pre>
</td>
</tr>
</table>
</div>