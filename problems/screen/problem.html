<div class="problembody">
<p>The ZOO management had been wondering for a long time how to
    increase the number of children visitors to the ZOO. The
    solution was surprising and unexpected in many ways. They
    installed a huge screen past the entrance and started to
    display short quizzes on it. The child in the crowd who first
    shouts out the answer to the quiz question is granted one day
    free access to the ZOO. The screen became soon very popular and
    various types of quizzes are routinely shown there. One type of
    the quiz is the math quiz containing arithmetic operations on
    integers. The management worries that older siblings and
    friends of the children might develop a math quiz screen
    hacking strategy: Snap the screen with the phone, run the image
    recognition SW which extracts formulas from the image,
    evaluates them, and presents the solution to the phone holder
    who immediately shouts out the answer.</p>
<p>Your task is to assess the difficulty of producing the
    screen hacking software. To get a better feel of the problem
    you will first develop a simple toy model application. Your
    code will read the formula presented in the preprocessed form
    of ASCII art and evaluate it.</p>
<h2>Input</h2>
<p>First line of each test case contains two integers
    <span class="tex2jax_process">$R$</span> and <span class="tex2jax_process">$C$</span> (<span class="tex2jax_process">$1
    \leq R \leq 3$</span>, <span class="tex2jax_process">$1 \leq C
    \leq 1\, 000$</span>). Each of the following <span class="tex2jax_process">$R$</span> lines contains <span class="tex2jax_process">$C$</span> characters. The whole matrix of
    <span class="tex2jax_process">$R \times C$</span> characters
    represents a single arithmetic formula written in ASCII art and
    generated by the following set of rules:</p>
<pre>
FORMULA -&gt; COMPLEX | FORMULA + COMPLEX | FORMULA - COMPLEX

COMPLEX -&gt; SQRT | FRACTION | TERM
          ______
SQRT -&gt; \/SIMPLE

            SIMPLE
FRACTION -&gt; ======
            SIMPLE

SIMPLE -&gt; TERM | SIMPLE + TERM | SIMPLE - TERM

TERM -&gt; INTEGER | INTEGER * TERM

INTEGER -&gt; 0 | 1 | 2 | 3 | ... | 999999 | 1000000
</pre>
<p>There are also a few additional specifications regarding the
    layout of the formula.</p>
<ul class="itemize">
<li>
<p>The horizontal bar of each <tt class="ttfamily">SQRT</tt> is made of one or more underscore
        symbols (‘<tt class="ttfamily">_</tt>’, ascii decimal code
        <span class="tex2jax_process">$95$</span>) and it always
        occupies the uppermost line of the formula in the
        screen.</p>
</li>
<li>
<p>When the formula occupies exactly two lines, then the
        first line contains only horizontal bars of all <tt class="ttfamily">SQRT</tt> parts of the formula.</p>
</li>
<li>
<p>When the formula occupies exactly three lines, then all
        <tt class="ttfamily">TERM</tt>s and all arithmetic
        operation symbols which are not part of any FRACTION or
        SQRT occupy the second line of the formula in the
        screen.</p>
</li>
<li>
<p>The length of the horizontal bar of <tt class="ttfamily">SQRT</tt> is the same as the length of
        <tt class="ttfamily">SIMPLE</tt> under the bar.</p>
</li>
<li>
<p>The fraction bar in <tt class="ttfamily">FRACTION</tt>
        consists of one or more equality signs, its length is equal
        to the maximum of the lengths of <tt class="ttfamily">SIMPLE</tt> above the bar and <tt class="ttfamily">SIMPLE</tt> below the bar.</p>
</li>
<li>
<p>There is always exactly one space preceding and
        following each arithmetic operation symbol (<tt class="ttfamily">+</tt>, <tt class="ttfamily">-</tt>, <tt class="ttfamily">*</tt>) on a particular line.</p>
</li>
<li>
<p>The formula exactly fits in to the <span class="tex2jax_process">$R \times C$</span> matrix, there are no
        blank/empty columns in front of the whole formula or behind
        it.</p>
</li>
</ul>
<p>The whole formula is evaluated according to the standard
    arithmetic rules. Namely: Each <tt class="ttfamily">FORMULA</tt> and each <tt class="ttfamily">TERM</tt>
    is evaluated from left to right. Each <tt class="ttfamily">SIMPLE</tt> is also evaluated from left to right
    with the additional standard condition that the multiplication
    has higher priority than the addition/subtraction. Evaluation
    of <tt class="ttfamily">SQRT</tt> and <tt class="ttfamily">FRACTION</tt> is also standard. The value of any
    evaluated <tt class="ttfamily">FORMULA</tt>, <tt class="ttfamily">COMPLEX</tt>, <tt class="ttfamily">SQRT</tt>,
    <tt class="ttfamily">FRACTION</tt>, <tt class="ttfamily">SIMPLE</tt> and <tt class="ttfamily">TERM</tt> is an
    integer whose absolute value does not exceed <span class="tex2jax_process">$1\, 000\, 000$</span>.</p>
<h2>Output</h2>
<p>For each test case print a separate line with the value
    <span class="tex2jax_process">$V$</span> of the input
    formula.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
1 13
1 + 2 * 3 - 4
</pre>
</td>
<td>
<pre>
3
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
2 16
  _________     
\/3 * 4 - 3 + 10
</pre>
</td>
<td>
<pre>
13
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>
3 5
6 * 4
=====
 12  
</pre>
</td>
<td>
<pre>
2
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 4</th>
<th>Sample Output 4</th>
</tr>
<tr>
<td>
<pre>
3 13
    22     __
3 - == - \/16
    11       
</pre>
</td>
<td>
<pre>
-3
</pre>
</td>
</tr>
</table>
</div>