<div class="problembody">
<p><em>Battleship</em> is a game played by two players. Each
    player has their own grid, which is hidden from their opponent.
    Each player secretly places some ships on their grid. Each ship
    covers a horizontal or vertical straight line of one or more
    contiguous squares. Ships cannot overlap. All ships are
    considered distinct, even if they have the same size. The
    orientation of each ship is not important to the game, only the
    squares they occupy.</p>
<p>After placing their ships, the players then take turns
    taking shots at their opponent’s ships by calling out a
    coordinate of their opponent’s grid. The opponent must honestly
    say whether the shot was a hit or a miss. When all of a ship’s
    squares are hit, that ship sinks (“You sunk my battleship!!”).
    A player loses when all of their ships are sunk.</p>
<p>Bob is playing a game of Mini Battleship against Alice.
    Regular Battleship is played on a <span class="tex2jax_process">$10 \! \times \! 10$</span> grid with
    <span class="tex2jax_process">$5$</span> ships. Mini Battleship
    is much smaller, with a grid no larger than <span class="tex2jax_process">$5 \! \times \! 5$</span> and possibly fewer
    than <span class="tex2jax_process">$5$</span> ships.</p>
<p>Bob wonders how many ship placements are possible on Alice’s
    board given what he knows so far. The answer will be
    <span class="tex2jax_process">$0$</span> if Alice is cheating!
    (Or, if the game setup isn’t possible.)</p>
<h2>Input</h2>
<p>The first line of input contains two space-separated
    integers <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$1 \le n \le 5$</span>) and <span class="tex2jax_process">$k$</span> (<span class="tex2jax_process">$1
    \le k \le 5$</span>), which represent a game of Mini Battleship
    played on an <span class="tex2jax_process">$n \! \times \!
    n$</span> grid with <span class="tex2jax_process">$k$</span>
    ships.</p>
<p>Each of the next <span class="tex2jax_process">$n$</span>
    lines contains a string <span class="tex2jax_process">$s$</span> (<span class="tex2jax_process">$|s|=n$</span>). This is what Bob sees of
    Alice’s grid so far.</p>
<ul class="itemize">
<li>
<p>A character ‘<tt class="tt">X</tt>’ represents one of
        Bob’s shots that missed.</p>
</li>
<li>
<p>A character ‘<tt class="tt">O</tt>’ (Letter O, not zero)
        represents one of Bob’s shots that hit.</p>
</li>
<li>
<p>A dot (‘<tt class="tt">.</tt>’) represents a square
        where Bob has not yet taken a shot.</p>
</li>
</ul>
<p>Each of the next <span class="tex2jax_process">$k$</span>
    lines contains a single integer <span class="tex2jax_process">$x$</span> (<span class="tex2jax_process">$1
    \le x \le n$</span>). These are the sizes of the ships.</p>
<h2>Output</h2>
<p>Output a single integer, which is the number of ways the
    <span class="tex2jax_process">$k$</span> distinct ships could
    be placed on Alice’s grid and be consistent with what Bob
    sees.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>4 3
....
.OX.
....
O..X
3
2
1
</pre>
</td>
<td>
<pre>132
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>4 4
.X.X
.XX.
...X
....
1
2
3
4
</pre>
</td>
<td>
<pre>6
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>2 2
..
..
2
2
</pre>
</td>
<td>
<pre>4
</pre>
</td>
</tr>
</table>
</div>