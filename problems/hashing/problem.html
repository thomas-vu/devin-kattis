<div class="problembody">
<p>Given is a string <span class="tex2jax_process">$S = s_0 s_1
    ... s_{N-1}$</span>. Your task is to compute hashes of
    substrings of this string.</p>
<p>You will be given a list of queries of the form <span class="tex2jax_process">$L, R$</span>. For each query, you should
    output a hash <span class="tex2jax_process">$H(L, R)$</span>
    such that for two hashes are equal if their corresponding
    substrings are equal (i.e. <span class="tex2jax_process">$H(L,
    R) = H(L’, R’)$</span> if <span class="tex2jax_process">$s_ L
    s_{L+1} ... S_{R - 1} = s_{L'} s_{L'+1} ... S_{R' -
    1}$</span>), and different with high probability if the
    corresponding substrings are different.</p>
<p>Your hashes should be non-negative <span class="tex2jax_process">$64$</span>-bit integers.</p>
<h2>Input</h2>
<p>The first line of input contains the string <span class="tex2jax_process">$S$</span>, consisting only of letters
    <tt class="ttfamily">a-z</tt>. The string will contain at least
    one letter and no more than <span class="tex2jax_process">$300\, 000$</span>.</p>
<p>The second line contains an integer <span class="tex2jax_process">$0 \le Q \le 300\, 000$</span>, the number of
    queries.</p>
<p>The next and final <span class="tex2jax_process">$Q$</span>
    lines contains one query each. A line will contain two
    space-separated integers <span class="tex2jax_process">$0 \le L
    &lt; R \le N$</span>.</p>
<h2>Output</h2>
<p>For each of the <span class="tex2jax_process">$Q$</span>
    queries <span class="tex2jax_process">$L, R$</span>, output an
    integer: your hash <span class="tex2jax_process">$H(L,
    R)$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
abba
6
0 1
3 4
1 2
2 3
0 2
2 4
</pre>
</td>
<td>
<pre>
33
33
34
34
143
124
</pre>
</td>
</tr>
</table>
</div>