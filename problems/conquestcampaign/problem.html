<div class="problembody">
<p><i class="itshape">Since the beginning of <span class="tex2jax_process">$30$</span>-th century, the Country of
    Circles has become the strongest country in the world. To
    expand its territory to the west, they plan to invade the
    Country of Rectangles.</i></p>
<p>The territory of the Country of Rectangles is represented by
    a <span class="tex2jax_process">$R \times C$</span> table,
    where rows are numbered from <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$R$</span>, and columns are numbered from
    <span class="tex2jax_process">$1$</span> to <span class="tex2jax_process">$C$</span>. The cell at the <span class="tex2jax_process">$i$</span>-th row and <span class="tex2jax_process">$j$</span>-th column is denoted as
    <span class="tex2jax_process">$(i, j)$</span>.</p>
<p>The Department of Defense of the Country of Circles plans to
    use its elite army of paratroopers to attack the Country of
    Rectangles. By sending spies to their opponent, they know that
    in the Country of Rectangles, <span class="tex2jax_process">$N$</span> cells <span class="tex2jax_process">$(x_1, y_1), (x_2, y_2), \ldots , (x_ N, y_
    N)$</span> are very weakly protected and can easily be
    dominated. Hence, they come up with the following plan:</p>
<ul class="itemize">
<li>
<p>On the first day, they plan to send a battalion of
        paratroopers to occupy each of these <span class="tex2jax_process">$N$</span> cells.</p>
</li>
<li>
<p>On each of the following days, they plan to send
        reinforcement to occupy all cells which share a common edge
        with at least one previously occupied cell.</p>
</li>
</ul>
<p>We assume that the Country of Circle’s force is strong
    enough that they can occupy any cell that they want.</p>
<p>The commander wants to know how many days it would take to
    conquer the whole country.</p>
<h2>Input</h2>
<ul class="itemize">
<li>
<p>The first line contains three integers <span class="tex2jax_process">$R$</span>, <span class="tex2jax_process">$C$</span> and <span class="tex2jax_process">$N$</span> <span class="tex2jax_process">$(1 \leq R, C \leq 100, \, 1 \leq N \leq
        10,000)$</span> — the number of rows, the number of columns
        of the Country of Rectangles’ territory and the number of
        weakly protected cells, respectively. It is not guaranteed
        that the cells are unique.</p>
</li>
<li>
<p>The <span class="tex2jax_process">$i$</span>-th of the
        remaining <span class="tex2jax_process">$N$</span> lines
        contains two integer <span class="tex2jax_process">$x_
        i$</span> and <span class="tex2jax_process">$y_ i$</span>
<span class="tex2jax_process">$(1 \leq x_ i \leq R, \, 1
        \leq y_ i \leq C)$</span> — one cell where paratroopers are
        sent during the first day of the campaign.</p>
</li>
</ul>
<h2>Output</h2>
<p>Print exactly one number — The number of days needed for the
    Country of Circles to completely conquer the Country of
    Rectangles.</p>
<h2>Explanation for the first example</h2>
<p>The figure below shows how the plan is operated for each
    day, where:</p>
<ul class="itemize">
<li>
<p>Unoccupied cells are in white.</p>
</li>
<li>
<p>Cells occupied on this day are filled with stripes.</p>
</li>
<li>
<p>Cells occupied on previous days are in solid color.</p>
</li>
</ul>
<center>
<img alt="\includegraphics[width=0.9\textwidth ]{c_sample.png}" src="/problems/conquestcampaign/file/statement/en/img-0001.png" style="width:90.00%"/>
</center>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>3 4 3
2 2
2 2
3 4
</pre>
</td>
<td>
<pre>3
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>2 3 6
1 1
1 2
1 3
2 1
2 2
2 3
</pre>
</td>
<td>
<pre>1
</pre>
</td>
</tr>
</table>
</div>