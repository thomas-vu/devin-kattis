<div class="problembody">
<p>The <em><b class="bfseries">Collatz function</b></em>,
    C(<em>n</em>), on positive integers is:</p>
<center>
<em>n</em>/2 if <em>n</em> is even and 3<em>n</em>+1 if
      <em>n</em> is odd
    </center>
<p>The <em><b class="bfseries">Collatz sequence</b></em>,
    CS(<em>n</em>), of a positive integer, <em>n</em>, is the
    sequence</p>
<center>
      CS(<em>n</em>) = n, C(<em>n</em>), C(C(<em>n</em>)),
      C(C(C(<em>n</em>))), …
    </center>
<p>For example, CS(12) = 12, 6, 3, 10, 5, 16, 8, 4, 2, 1, 4, 2,
    1, …</p>
<p>The <em><b class="bfseries">Collatz Conjecture</b></em>
    (also known as the <em>3n+1 problem</em>) is that
    CS(<em>n</em>) for every positive integer <em>n</em> eventually
    ends repeating the sequence 4, 2, 1. To date, the status of
    this conjecture is still unknown. No proof has been given and
    no counterexample has been found up to very large values.</p>
<p>Prof. Fumblemore wants to study the problem using
    <em>Collatz sequence types</em>. The <em>Collatz sequence
    type</em> (CST) of an integer <em>n</em>, CST(<em>n</em>) is a
    sequence of letters E and O (for even and odd) which describe
    the parity of the values in CS(<em>n</em>) up to but not
    including the first power of 2. So,</p>
<center>
      CST(12) = EEOEO
    </center>
<p>Note that</p>
<center>
      CS(908) = 908, 454, 227, 682, 341, 1024, 512, 256, 128, 64,
      32, 16, 8, 4, 3, 2, …
    </center>
<p>so 12 and 908 have the same CST.</p>
<p>Prof. Fumblemore needs a program which allows him to
    enter a sequence of E’s and O’s and returns the <b class="bfseries">smallest</b> integer <em>n</em> for which the given
    sequence is CST(<em>n</em>).</p>
<p>Notes:</p>
<ul class="itemize">
<li>
<p>E’s are even numbers which are not powers of 2,</p>
</li>
<li>
<p>O’s are odd numbers greater than 1.</p>
</li>
<li>
<p>The last letter in a sequence must be an O (if
        C(<em>n</em>) is a power of 2, so is <em>n</em>)</p>
</li>
<li>
<p>There can not be two O’s in succession (C(odd) =
        even)</p>
</li>
<li>
<p>Since, Prof. Fumblemore does not type well, you
        must check that the input sequence is valid before
        attempting to find <em>n</em>. That is, the sequence
        contains only E’s and O’s, ends in O and no two O’s are
        adjacent.</p>
</li>
</ul>
<h2>Input</h2>
<p>Input consists of one line containing a string of up to 50
    letters composed of E’s and O’s.</p>
<h2>Output</h2>
<p>There is one line of output that consists of the string
    <tt class="ttfamily">INVALID</tt> if the input line is invalid,
    or a single decimal integer, <em>n</em>, such that <em>n</em>
    is the <em>smallest</em> integer for which CST(<em>n</em>) is
    the input sequence. Input will be chosen such that <span class="tex2jax_process">$n \le 2^{47}$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>EEOEO
</pre>
</td>
<td>
<pre>12
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>EEOOEO
</pre>
</td>
<td>
<pre>INVALID
</pre>
</td>
</tr>
</table>
</div>