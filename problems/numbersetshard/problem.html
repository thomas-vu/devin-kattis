<div class="problembody">
<p><em>Note that this is a harder version of the problem
    numbersetseasy.</em></p>
<p>You start with a sequence of consecutive integers. You want
    to group them into sets.</p>
<p>You are given the interval, and an integer <span class="tex2jax_process">$P$</span>. Initially, each number in the
    interval is in its own set.</p>
<p>Then you consider each pair of integers in the interval. If
    the two integers share a prime factor which is at least
    <span class="tex2jax_process">$P$</span>, then you merge the
    two sets to which the two integers belong.</p>
<p>How many different sets there will be at the end of this
    process?</p>
<h2>Input</h2>
<p>One line containing an integer <span class="tex2jax_process">$C\leq 10$</span>, the number of test cases
    in the input file.</p>
<p>For each test case, there will be one line containing three
    single-space-separated integers <span class="tex2jax_process">$A, B$</span>, and <span class="tex2jax_process">$P$</span>. <span class="tex2jax_process">$A$</span> and <span class="tex2jax_process">$B$</span> are the first and last integers in
    the interval, and <span class="tex2jax_process">$P$</span> is
    the number as described above.</p>
<p>You may assume that <span class="tex2jax_process">$1 \leq
    A\leq B\leq 10^{12}, B\leq A+1\, 000\, 000$</span> and
    <span class="tex2jax_process">$2\leq P\leq B$</span>.</p>
<h2>Output</h2>
<p>For each test case, output one line containing the string
    "Case #<span class="tex2jax_process">$X$</span>: <span class="tex2jax_process">$Y$</span>" where <span class="tex2jax_process">$X$</span> is the number of the test case,
    starting from 1, and <span class="tex2jax_process">$Y$</span>
    is the number of sets.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
2
10 20 5
10 20 3
</pre>
</td>
<td>
<pre>
Case #1: 9
Case #2: 7
</pre>
</td>
</tr>
</table>
</div>