<div class="problembody">
<div class="illustration" style="width:40.00%">
<img alt="/problems/kindergarten/file/statement/en/img-0001.jpg" class="illustration" src="/problems/kindergarten/file/statement/en/img-0001.jpg"/>
<div class="description">
        Photo by <a href="http://www.flickr.com/photos/criminalintent/5963265978/">Lars
        Plougmann</a>
</div>
</div>
<p>Every year the three friendly teachers at the kindergarten
    let their classes’ kids change classes to form three new ones.
    Some kids, of course, are old enough to leave, but those who
    stay for another year are rearranged among the three
    teachers.</p>
<p>The teachers even let the kids have their say in the
    process. As friendship both comes and goes hastily in young
    years, each kid <span class="tex2jax_process">$X$</span> ranks
    every other kid <span class="tex2jax_process">$Y$</span>
    according to how glad <span class="tex2jax_process">$X$</span>
    would be to have <span class="tex2jax_process">$Y$</span> in
    her new class. In fact, <span class="tex2jax_process">$X$</span> produces a preference list giving
    a total order of the other kids, i.e. there are no such things
    as ties – kids she would be equally glad to have as
    classmates.</p>
<p>The three teachers do not mind if the new classes formed are
    unbalanced in size, since they fill up their classes with new
    kids about to start their first year at the kindergarten. They
    do, however, want all the kids in their own new class to be
    different from last year, since even a teacher needs a break
    after a whole year with the same kids. They decide that a best
    partition into three classes under these premises is one where
    no kid is in the same class as a kid not listed among the top
    <span class="tex2jax_process">$T$</span> entries on their
    preference list, for <span class="tex2jax_process">$T$</span>
    as small as possible. Note that the kids in a new class may
    very well be the same as in an old one, but then with a new
    teacher!</p>
<h2>Input</h2>
<p>The first line of input contains an integer <span class="tex2jax_process">$1\leq N \leq 200$</span> giving the number
    of kids to be rearranged at the kindergarten. The kids are
    numbered <span class="tex2jax_process">$1$</span> through
    <span class="tex2jax_process">$N$</span>.</p>
<p>Then follow <span class="tex2jax_process">$N$</span> lines
    describing the kids. The <span class="tex2jax_process">$i$</span>-th row first contains the
    identifier of their current class’ teacher (an integer
    <span class="tex2jax_process">$0$</span>, <span class="tex2jax_process">$1$</span>, or <span class="tex2jax_process">$2$</span>), and next the <span class="tex2jax_process">$N-1$</span> integers <span class="tex2jax_process">$\{ 1,2,3,…,i-1,i+1,…,N\} $</span> in some
    order, describing the classmate preference list of the
    <span class="tex2jax_process">$i$</span>-th kid, in descending
    order.</p>
<h2>Output</h2>
<p>The smallest non-negative integer <span class="tex2jax_process">$T$</span>, such that there is a partitioning
    of the kids in three new classes such that</p>
<ul class="itemize">
<li>
<p>no kid has the same teacher as in their current class,
        and</p>
</li>
<li>
<p>all kids’ classmates are among the top <span class="tex2jax_process">$T$</span> places of their preference
        lists, respectively.</p>
</li>
</ul>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
6
0 2 3 4 5 6
0 1 3 4 5 6
1 6 5 4 2 1
2 6 5 3 2 1
1 1 2 3 4 6
2 1 2 3 4 5
</pre>
</td>
<td>
<pre>
4
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
3
0 2 3
1 1 3
2 1 2
</pre>
</td>
<td>
<pre>
0
</pre>
</td>
</tr>
</table>
</div>