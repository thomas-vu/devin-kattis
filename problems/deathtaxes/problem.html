<div class="problembody">
<div class="illustration" style="width:30.00%">
<img alt="/problems/deathtaxes/file/statement/en/img-0001.jpg" class="illustration" src="/problems/deathtaxes/file/statement/en/img-0001.jpg"/>
<div class="description">
        Mittens. <a href="https://pixabay.com/en/cat-grumpy-upset-sad-cute-emotion-1599158/">
        Picture</a> by JamieDepledge1 via Pixabay, cc0
      </div>
</div>Kattis’ grumpy old aunt Mittens in Taxmania has recently
    died at a tender age of <span class="tex2jax_process">$109$</span> cat years. Among her many papers
    are her stock records. As it turns out, Mittens traded a lot in
    the stock of her namesake mitten-producing company Mittens
    Conglomerated.

    <p>In Taxmania dead cats are prohibited from owning stock, so
    when Mittens died, all her shares (units) of stock in Mittens
    Conglomerated were sold, with <span class="tex2jax_process">$30\% $</span> of the capital gains paid as
    taxes. Your task is to compute how much money the final sale of
    Mittens’ shares yields, after paying taxes on the profits.
    There are no tax effects from selling at a loss.</p>
<p>Mittens stock records indicate the history of her
    <em>purchases</em> and <em>sales</em> of shares, and at what
    costs they were made. In addition, they indicate when the
    company performed <em>splits</em> and <em>merges</em> of its
    stock. When the company <em>splits</em> its stock, every share
    is replaced by <span class="tex2jax_process">$x$</span> new
    shares, and the value divided evenly between them. When the
    company <em>merges</em> its stock, every <span class="tex2jax_process">$x$</span> shares are replaced by a single
    stock. If Mittens can not merge all her shares (due to her
    number of shares not being divisible by <span class="tex2jax_process">$x$</span>), she is forced to sell any
    remainder stock (at a price equal to the current average cost
    of her shares).</p>
<p>For example, consider the following sequence of events
    (corresponding to Sample Input 2):</p>
<ol class="enumerate">
<li>
<p>Mittens <em>buys</em> <span class="tex2jax_process">$10$</span> shares for <span class="tex2jax_process">$10$</span> crowns per share.</p>
</li>
<li>
<p>Mittens <em>buys</em> <span class="tex2jax_process">$30$</span> shares for <span class="tex2jax_process">$5$</span> crowns per share. The average
        cost of her <span class="tex2jax_process">$40$</span>
        shares is now <span class="tex2jax_process">$\frac{10 \cdot
        10 + 30 \cdot 5}{10 + 30} = 6.25$</span> crowns.</p>
</li>
<li>
<p>Mittens <em>sells</em> <span class="tex2jax_process">$31$</span> shares for <span class="tex2jax_process">$8$</span> crowns per share. The profit
        is <span class="tex2jax_process">$8-6.25=1.75$</span>
        crowns per share (which is subject to capital gains tax but
        that is irrelevant). The sale does not change the average
        cost of Mittens’ shares.</p>
</li>
<li>
<p>The company performs a <em>split</em> with <span class="tex2jax_process">$x=2$</span>. Mittens’ shares split into
        <span class="tex2jax_process">$2 \cdot 9 = 18$</span>
        shares, of average cost <span class="tex2jax_process">$6.25
        / 2 = 3.125$</span>.</p>
</li>
<li>
<p>The company performs a <em>merge</em> with <span class="tex2jax_process">$x=8$</span>. Mittens merges <span class="tex2jax_process">$16$</span> of her <span class="tex2jax_process">$18$</span> shares into <span class="tex2jax_process">$2$</span> new shares of average cost
        <span class="tex2jax_process">$8 \cdot 3.125 = 25$</span>.
        The last two remaining old shares can not be merged and
        Mittens is forced to sell them.</p>
</li>
<li>
<p>Mittens <em>dies</em> and her <span class="tex2jax_process">$2$</span> shares are sold for
        <span class="tex2jax_process">$42$</span> crowns per share.
        The profit is <span class="tex2jax_process">$42-25=17$</span> crowns per share, which
        is subject to the <span class="tex2jax_process">$30\%
        $</span> tax. The total amount obtained from the final sale
        after taxes is thus <span class="tex2jax_process">$2 \cdot
        (42 - 17 \cdot 0.3) = 73.8$</span> crowns.</p>
</li>
</ol>
<h2>Input</h2>
<p>The input contains a sequence of at most <span class="tex2jax_process">$10\, 000$</span> events in chronological
    order. Each event is in one of the following forms:</p>
<ul class="itemize">
<li>
<p>“<tt class="ttfamily">buy <span class="tex2jax_process">$x$</span> <span class="tex2jax_process">$y$</span></tt>”: Mittens bought
        <span class="tex2jax_process">$x$</span> shares of stock at
        <span class="tex2jax_process">$y$</span> crowns per
        share.</p>
</li>
<li>
<p>“<tt class="ttfamily">sell <span class="tex2jax_process">$x$</span> <span class="tex2jax_process">$y$</span></tt>”: Mittens sold
        <span class="tex2jax_process">$x$</span> shares of stock at
        <span class="tex2jax_process">$y$</span> crowns per share
        (and used the money for purposes unknown). The value of
        <span class="tex2jax_process">$x$</span> is no greater than
        the number of shares owned before the event.</p>
</li>
<li>
<p>“<tt class="ttfamily">split <span class="tex2jax_process">$x$</span></tt>”: The stock split with
        <span class="tex2jax_process">$x$</span> new shares for
        each share.</p>
</li>
<li>
<p>“<tt class="ttfamily">merge <span class="tex2jax_process">$x$</span></tt>”: The stock merged with
        one new share for every <span class="tex2jax_process">$x$</span> shares.</p>
</li>
<li>
<p>“<tt class="ttfamily">die <span class="tex2jax_process">$y$</span></tt>”: The remaining shares
        were sold off at the death of Mittens for <span class="tex2jax_process">$y$</span> crowns per share. This event
        happens exactly once and is guaranteed to be the last event
        in the input.</p>
</li>
</ul>
<p>In all events, <span class="tex2jax_process">$x$</span> and
    <span class="tex2jax_process">$y$</span> are integers
    satisfying <span class="tex2jax_process">$1 \le x \le 1\,
    000$</span> and <span class="tex2jax_process">$1 \le y \le 1\,
    000$</span>. You may assume that at any point in time in the
    event history, the total number of shares of stock owned by
    Mittens was at most <span class="tex2jax_process">$10^6$</span>.</p>
<h2>Output</h2>
<p>Output a single line containing the number of crowns
    obtained (after paying taxes) in the final sale of Mittens’
    stock after her death. The answer should be accurate to within
    an absolute error of at most <span class="tex2jax_process">$0.01$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
buy 1 15
split 3
sell 1 5
die 4
</pre>
</td>
<td>
<pre>
8.00000000
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>
buy 10 10
buy 30 5
sell 31 8
split 2
merge 8
die 42
</pre>
</td>
<td>
<pre>
73.8
</pre>
</td>
</tr>
</table>
</div>