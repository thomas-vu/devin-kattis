<div class="problembody">
<div class="figure" id="a0000000004">
<center>
<img alt="\includegraphics[width=0.5\textwidth ]{fig}" src="/problems/crashingrobots/file/statement/en/img-0001.png" style="width:50.00%"/>
<div class="caption">
<b>Figure 1</b>: The starting positions of the robots in
          the sample warehouse
        </div>
</center>
</div>
<p>In a modernized warehouse, robots are used to fetch the
    goods. Careful planning is needed to ensure that the robots
    reach their destinations without crashing into each other. Of
    course, all warehouses are rectangular, and all robots occupy a
    circular floor space with a diameter of <span class="tex2jax_process">$1$</span> meter. Assume there are
    <span class="tex2jax_process">$N$</span> robots, numbered from
    <span class="tex2jax_process">$1$</span> through <span class="tex2jax_process">$N$</span>. You will get to know the position
    and orientation of each robot, and all the instructions, which
    are carefully (and mindlessly) followed by the robots.
    Instructions are processed in the order they come. No two
    robots move simultaneously; a robot always completes its move
    before the next one starts moving.</p>
<p>A robot crashes with a wall if it attempts to move outside
    the area of the warehouse, and two robots crash with each other
    if they ever try to occupy the same spot.</p>
<h2>Input</h2>
<p>The first line of input contains an integer <span class="tex2jax_process">$1 \le K \le 50$</span>, the number of test
    cases. Each test case starts with one line consisting of two
    integers, <span class="tex2jax_process">$1 \le A, B \le
    100$</span>, giving the size of the warehouse in meters.
    <span class="tex2jax_process">$A$</span> is the length in the
    EW-direction, and <span class="tex2jax_process">$B$</span> in
    the NS-direction.</p>
<p>The second line contains two integers, <span class="tex2jax_process">$1 \le N, M \le 100$</span>, denoting the
    numbers of robots and instructions respectively.</p>
<p>Then follow <span class="tex2jax_process">$N$</span> lines
    with two integers, <span class="tex2jax_process">$1 \le X_ i
    \le A, 1 \le Y_ i \le B$</span> and one letter (<tt class="ttfamily">N</tt>, <tt class="ttfamily">S</tt>, <tt class="ttfamily">E</tt> or <tt class="ttfamily">W</tt>), giving the
    starting position and direction of each robot, in order from
    <span class="tex2jax_process">$1$</span> through <span class="tex2jax_process">$N$</span>. No two robots start at the same
    position.</p>
<p>Finally there are <span class="tex2jax_process">$M$</span>
    lines, giving the instructions in sequential order. An
    instruction has the following format:<br/></p>
<p><tt>&lt;robot #&gt; &lt;action&gt;
    &lt;repeat&gt;</tt><br/></p>
<p>Where <tt>&lt;action&gt;</tt> is one of</p>
<ul class="itemize">
<li>
<p><tt>L</tt>: turn left <span class="tex2jax_process">$90$</span> degrees,</p>
</li>
<li>
<p><tt>R</tt>: turn right <span class="tex2jax_process">$90$</span> degrees, or</p>
</li>
<li>
<p><tt>F</tt>: move forward one meter,</p>
</li>
</ul>
<p>and <span class="tex2jax_process">$1 \le
    \texttt{&lt;repeat&gt;} \le 100$</span> is the number of times
    the robot should perform this single move.</p>
<h2>Output</h2>
<p>Output one line for each test case:</p>
<ul class="itemize">
<li>
<p><tt class="ttfamily">Robot <span class="tex2jax_process">$i$</span> crashes into the wall</tt>, if
        robot <span class="tex2jax_process">$i$</span> crashes into
        a wall. (A robot crashes into a wall if <span class="tex2jax_process">$X_ i = 0$</span>, <span class="tex2jax_process">$X_ i = A+1$</span>, <span class="tex2jax_process">$Y_ i = 0$</span> or <span class="tex2jax_process">$Y_ i = B+1$</span>.)</p>
</li>
<li>
<p><tt class="ttfamily">Robot <span class="tex2jax_process">$i$</span> crashes into robot
        <span class="tex2jax_process">$j$</span></tt>, if robots
        <span class="tex2jax_process">$i$</span> and <span class="tex2jax_process">$j$</span> crash, and <span class="tex2jax_process">$i$</span> is the moving robot.</p>
</li>
<li>
<p><tt class="ttfamily">OK</tt>, if no crashing occurs.</p>
</li>
</ul>
<p>Only the first crash is to be reported.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>4
5 4
2 2
1 1 E
5 4 W
1 F 7
2 F 7
5 4
2 4
1 1 E
5 4 W
1 F 3
2 F 1
1 L 1
1 F 3
5 4
2 2
1 1 E
5 4 W
1 L 96
1 F 2
5 4
2 3
1 1 E
5 4 W
1 F 4
1 L 1
1 F 20
</pre>
</td>
<td>
<pre>Robot 1 crashes into the wall
Robot 1 crashes into robot 2
OK
Robot 1 crashes into robot 2
</pre>
</td>
</tr>
</table>
</div>