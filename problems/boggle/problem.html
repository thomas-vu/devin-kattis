<div class="problembody">
<p>I am sure, you are a big fan of the board game
    “<em>Boggle</em>”. Don’t worry if you are not familiar with the
    rules, I will explain them to you. A Boggle is a <span class="tex2jax_process">$4 \times 4$</span> grid of letters where
    your job is to find as many words as you can. If I play Boggle
    with (or against) my wife, she always wins – the loser (that’s
    me) then always has to do all these little jobs like to take
    out the trash. So, please help me to win again.</p>
<p>Words in a Boggle can be constructed from adjacent letters
    (i.e. horizontally, vertically and diagonally), but the
    same dice may only be used once in a word. The words have to be
    listed in our dictionary to be valid.</p>
<p>Words with <span class="tex2jax_process">$3$</span> or
    <span class="tex2jax_process">$4$</span> letters count
    <span class="tex2jax_process">$1$</span> point, words with
    <span class="tex2jax_process">$5$</span> letters <span class="tex2jax_process">$2$</span> points, <span class="tex2jax_process">$6$</span> letters <span class="tex2jax_process">$3$</span> points, <span class="tex2jax_process">$7$</span> letters <span class="tex2jax_process">$5$</span> points. <span class="tex2jax_process">$8$</span> letter words will give
    <span class="tex2jax_process">$11$</span> points. If you find
    more than one word (and I hope you do), points will be summed
    up to form your score.</p>
<h2>Input</h2>
<p>There is only one test case per file. The first line
    contains the number of words <span class="tex2jax_process">$w$</span> in the dictionary (<span class="tex2jax_process">$1 &lt; w &lt; 300\, 000$</span>). Then
    follow <span class="tex2jax_process">$w$</span> lines, each
    containing one word. Words consist of up to <span class="tex2jax_process">$8$</span> upper case letters (’<tt class="tt">A</tt>’-’<tt class="tt">Z</tt>’). After the dictionary
    specification, there is a blank line. Then follows the number
    of Boggle boards <span class="tex2jax_process">$b$</span> in
    one line (<span class="tex2jax_process">$1 &lt; b &lt;
    30$</span>). Each boggle is given as a <span class="tex2jax_process">$4\times 4$</span> grid of upper case letters
    in four lines. Boggles are separated by blank lines.</p>
<h2>Output</h2>
<p>For each boggle, print one line containing the maximal
    possible score, the longest word and number of found words.
    Words that are twice (or more often) in one Boggle, only count
    once. If there is more than one longest word, print the
    lexicographically smallest one. You may safely assume that
    there is at least one valid word in each Boggle.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
5
ICPC
ACM
CONTEST
GCPC
PROGRAMM

3
ACMA
APCA
TOGI
NEST

PCMM
RXAI
ORCN
GPCG

ICPC
GCPC
ICPC
GCPC
</pre>
</td>
<td>
<pre>
8 CONTEST 4
14 PROGRAMM 4
2 GCPC 2
</pre>
</td>
</tr>
</table>
</div>