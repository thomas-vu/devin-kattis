<div class="problembody">
<p>On an <span class="tex2jax_process">$n \times n$</span>
    chessboard, the Prince and the Princess play a game. The
    squares on the chessboard are numbered <span class="tex2jax_process">$1, 2, 3, \ldots , n^2$</span>, as shown in
    Figure 1:</p>
<div class="figure" id="fig:prince2">
<center>
<img alt="\includegraphics[width=0.35\textwidth ]{prince1}" src="/problems/princeandprincess/file/statement/en/img-0001.jpg" style="width:35.00%"/>
<div class="caption">
<b>Figure 1</b>: The chessboard.
        </div>
</center>
</div>
<p>The Prince stands in square <span class="tex2jax_process">$1$</span>, makes <span class="tex2jax_process">$p$</span> jumps and finally reaches square
    <span class="tex2jax_process">$n^2$</span>. He enters a square
    at most once. So if we use <span class="tex2jax_process">$x_
    i$</span> to denote the <span class="tex2jax_process">$i$</span>:th square he enters, then
    <span class="tex2jax_process">$x_1, x_2, \ldots ,
    x_{p+1}$</span> are all different. Note that <span class="tex2jax_process">$x_{1}=1$</span> and <span class="tex2jax_process">$x_{p+1}=n^2$</span>.</p>
<p>The Princess does essentially the same thing – stands in
    square <span class="tex2jax_process">$1$</span>, makes
    <span class="tex2jax_process">$q$</span> jumps and fainally
    reaches square <span class="tex2jax_process">$n^2$</span>. We
    use <span class="tex2jax_process">$y_{1}, y_{2}, \ldots
    y_{q+1}$</span> to denote the sequence, and all <span class="tex2jax_process">$q+1$</span> numbers are different.</p>
<p>Figure 2 below shows a <span class="tex2jax_process">$3
    \times 3$</span> square, a possible route for the Prince and a
    different route for the Princess.</p>
<div class="figure">
<center>
<img alt="\includegraphics[width=0.55\textwidth ]{prince2}" src="/problems/princeandprincess/file/statement/en/img-0002.jpg" style="width:55.00%"/>
</center>
</div>
<p>The Prince moves along the sequence: <span class="tex2jax_process">$1 \rightarrow 7 \rightarrow 5 \rightarrow 4
    \rightarrow 8 \rightarrow 3 \rightarrow 9$</span> (Black
    arrows), while the Princess moves along this sequence:
    <span class="tex2jax_process">$1 \rightarrow 4 \rightarrow 3
    \rightarrow 5 \rightarrow 6 \rightarrow 2 \rightarrow 8
    \rightarrow 9$</span> (White arrows).</p>
<p>The King, their father, has just come. “Why move separately?
    You are brother and sister!”, said the King, “Ignore some jumps
    and make sure that you’re always together.”</p>
<p>For example, if the Prince ignores his 2:nd, 3:rd, and 6:th
    jump, he’ll follow the route: <span class="tex2jax_process">$1
    \rightarrow 4 \rightarrow 8 \rightarrow 9$</span>. If the
    Princess ignores her 3:rd, 4:th, 5:th, 6:th jump, she’ll follow
    the same route: <span class="tex2jax_process">$1 \rightarrow 4
    \rightarrow 8 \rightarrow 9$</span>, (The common route is shown
    in Figure 3) thus satisfying the King. The King wants to know
    the longest route they can move together. Could you tell
    him?</p>
<h2>Input</h2>
<p>The first line of the input contains a single integer
    <span class="tex2jax_process">$t$</span>, the number of test
    cases to follow. For each case, the first line contains three
    integers <span class="tex2jax_process">$n, p, q$</span>
    (<span class="tex2jax_process">$2 \le n \le 250, 1 \le p, q
    &lt; n^2$</span>). The second line contains <span class="tex2jax_process">$p+1$</span> different integers in the range
    <span class="tex2jax_process">$[1 \ldots n^2]$</span>, the
    sequence of the Prince. The third line contains <span class="tex2jax_process">$q+1$</span> different integers in the range
    <span class="tex2jax_process">$[1 \ldots n^2]$</span>, the
    sequence of the Princess.</p>
<h2>Output</h2>
<p>For each test case, print the case number and the length of
    longest route they can move together. Look at the output for
    sample input for details.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
1
3 6 7
1 7 5 4 8 3 9
1 4 3 5 6 2 8 9
</pre>
</td>
<td>
<pre>
Case 1: 4
</pre>
</td>
</tr>
</table>
</div>