<div class="problembody">
<p>You are hired as a level designer for the next Pok√©mon
    series, with games called <em>Ice</em> and <em>Fire</em>. For
    the first of these two games, players have to get through a
    maze in an icy cave. The cave is represented as a grid, with
    each square of the grid being either ice, gravel or an
    obstacle.</p>
<p>The player will start at a square, and then make a number of
    moves, each move represented by one of the four cardinal
    directions. The maze behaves in the following way. Assume that
    the square the player is trying to move into is an obstacle. In
    this case, the player does not move. If the square the player
    is moving into is gravel, the player successfully moves to the
    square and will stand still on the square. If the square is ice
    however, the player will first be transferred into that square,
    and then repeat the procedure again in the same direction. This
    means the player will glide on the ice until either colliding
    with an obstacle or reaching a square filled with gravel.
    Gliding on ice counts only as one move.</p>
<p>You have almost finished your level design. In the maze,
    there is a goal square that you wish to reach. You still have
    to choose a square to be the starting point of the player.
    Since you do not want the level to be too easy, you want to
    make sure the number of moves needed to get from the starting
    point to the goal is sufficiently high.</p>
<p>Can you compute the minimum number of <em>moves</em> needed
    to get from each point in the maze to the goal? Note that move
    may result in the player traveling multiple squares if gliding
    on the ice.</p>
<h2>Input</h2>
<p>The first line of the input contains the two integers
    <span class="tex2jax_process">$3 \le C \le 1\, 000$</span> and
    <span class="tex2jax_process">$3 \le R \le 1\, 000$</span>, the
    number of columns and rows that the maze consists of.</p>
<p>The next <span class="tex2jax_process">$R$</span> lines
    contains <span class="tex2jax_process">$C$</span> characters
    each, describing the maze. Each square in the maze is
    represented by one of the following characters:</p>
<ul class="itemize">
<li>
<p>a period (<tt class="ttfamily">.</tt>) represents a
        gravel square</p>
</li>
<li>
<p>a pound sign (<tt class="ttfamily">#</tt>) represents an
        obstacle</p>
</li>
<li>
<p>an underscore (<tt class="ttfamily">_</tt>) represents
        an ice square</p>
</li>
<li>
<p>an M (<tt class="ttfamily">M</tt>) represents the goal
        in the maze, which is also covered in gravel</p>
</li>
</ul>
<p>The edges of the maze are always surrounded by obstacle
    squares.</p>
<h2>Output</h2>
<p>Output <span class="tex2jax_process">$R$</span> lines with
    <span class="tex2jax_process">$C$</span> integers each, one for
    each square, containing the number of moves needed to reach the
    goal.</p>
<p>If it is not possible to reach the target from a square,
    output <span class="tex2jax_process">$-1$</span> instead for
    that square.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>5 6
#####
#...#
#_###
#_M.#
#__.#
#####
</pre>
</td>
<td>
<pre>-1 -1 -1 -1 -1
-1 4 5 6 -1
-1 4 -1 -1 -1
-1 1 0 1 -1
-1 3 1 2 -1
-1 -1 -1 -1 -1
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>5 6
#####
##__#
##__#
##M_#
##_##
#####
</pre>
</td>
<td>
<pre>-1 -1 -1 -1 -1
-1 -1 1 2 -1
-1 -1 1 2 -1
-1 -1 0 1 -1
-1 -1 1 -1 -1
-1 -1 -1 -1 -1
</pre>
</td>
</tr>
</table>
</div>