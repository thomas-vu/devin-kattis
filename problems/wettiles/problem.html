<div class="problembody">
<p>Alice owns a construction company in the town of Norainia,
    famous for its unusually dry weather. In fact, it only rains a
    few days per year there. Because of this phenomenon, many
    residents of Norainia neglect to do roof repairs until leaks
    occur and ruin their floors. Every year, Alice receives a
    deluge of calls from residents who need the leaks fixed and
    floor tiles replaced. While exquisite in appearance, Norainia
    floor tiles are not very water resistant; once a tile becomes
    wet, it is ruined and must be replaced. This year, Alice plans
    to handle the rainy days more efficiently than in past years.
    She will hire extra contractors to dispatch as soon as the
    calls come in, so hopefully all leaks can be repaired as soon
    as possible. For each house call, Alice needs a program to help
    her determine how many replacement tiles a contractor team will
    need to bring to complete the job.</p>
<p>For a given house, square floor tiles are arranged in a
    rectangular grid. Leaks originate from one or more known source
    locations above specific floor tiles. After the first minute,
    the tiles immediately below the leaks are ruined. After the
    second minute, water will have spread to any tile that shares
    an edge with a previously wet tile. This pattern of spreading
    water continues for each additional minute. However, the walls
    of a house restrict the water; if a damaged area hits a wall,
    the water does not penetrate the wall. We assume there are
    always four outer walls surrounding the entire house. A house
    may also have a number of additional “inner” walls; each inner
    wall is comprised of a connected linear sequence of locations
    (which may or may not be connected to the outer walls or to
    each other).</p>
<p>As an example, Figure 1 shows water damage (in gray) that
    would result from three initial leaks (each marked with a white
    letter ‘L’) after each of the first five minutes of time. Tiles
    labeled ‘<span class="tex2jax_process">$2$</span>’ become wet
    during the second minute, tiles labeled ‘<span class="tex2jax_process">$3$</span>’ become wet during the third
    minute, and so forth. The black areas designate inner walls
    that restrict the flow of water. Note that after <span class="tex2jax_process">$5$</span> minutes, a total of <span class="tex2jax_process">$75$</span> tiles have been damaged and will
    need to be replaced. Figures 2 through 4 show other houses that
    correspond to the example inputs for this problem.</p>
<div class="figure">
<center>
<table cellspacing="0" class="tabular">
<tr>
<td style="text-align:center">
<p><img alt="\includegraphics[height=2in]{fig1.png}" src="/problems/wettiles/file/statement/en/img-0001.png" style="height:2in"/></p>
</td>
</tr>
<tr>
<td style="text-align:center">
<p>Figure 1</p>
</td>
</tr>
</table>
<table cellspacing="0" class="tabular">
<tr>
<td style="text-align:center">
<p><img alt="\includegraphics[height=2in]{fig2.png}" src="/problems/wettiles/file/statement/en/img-0002.png" style="height:2in"/></p>
</td>
<td style="text-align:center">
<p><img alt="\includegraphics[height=2in]{fig3.png}" src="/problems/wettiles/file/statement/en/img-0003.png" style="height:2in"/></p>
</td>
<td style="text-align:center">
<p><img alt="\includegraphics[height=2in]{fig4.png}" src="/problems/wettiles/file/statement/en/img-0004.png" style="height:2in"/></p>
</td>
</tr>
<tr>
<td style="text-align:center">
<p>Figure 2</p>
</td>
<td style="text-align:center">
<p>Figure 3</p>
</td>
<td style="text-align:center">
<p>Figure 4</p>
</td>
</tr>
</table>
</center>
</div>
<h2>Input</h2>
<p>The input is composed of <span class="tex2jax_process">$N$</span> test cases (<span class="tex2jax_process">$1 \leqslant N \leqslant 20$</span>), each
    representing a house.</p>
<p>Each house is described beginning with a line having five
    integral parameters: <span class="tex2jax_process">$X\ Y\ T\ L\
    W$</span>. Parameters <span class="tex2jax_process">$X$</span>
    and <span class="tex2jax_process">$Y$</span> designate the
    dimensions of the rectangular grid, with <span class="tex2jax_process">$1 \leqslant X \leqslant 1000$</span> and
    <span class="tex2jax_process">$1 \leqslant Y \leqslant
    1000$</span>. The coordinate system is one-indexed, as shown in
    the earlier figures. Parameter <span class="tex2jax_process">$T$</span> designates the number of minutes
    that pass before a team of contractors arrives at a house and
    stops the leaks, with <span class="tex2jax_process">$1
    \leqslant T \leqslant 200\, 000$</span>. The parameter L
    designates the number of leaks, with <span class="tex2jax_process">$1 \leqslant L \leqslant 100$</span>.
    Parameter <span class="tex2jax_process">$W$</span> designates
    the number of inner walls in the house, <span class="tex2jax_process">$0 \leqslant W \leqslant 100$</span>.</p>
<p>The following <span class="tex2jax_process">$2\cdot
    L$</span> integers in the test case, on one or more lines, are
    distinct <span class="tex2jax_process">$(x y)$</span> pairs
    that designate the locations of the <span class="tex2jax_process">$L$</span> distinct leaks, such that
    <span class="tex2jax_process">$1 \leqslant x \leqslant
    X$</span> and <span class="tex2jax_process">$1 \leqslant y
    \leqslant Y$</span>.</p>
<p>If <span class="tex2jax_process">$W &gt; 0$</span>, there
    will be <span class="tex2jax_process">$4\cdot W$</span>
    additional integers, on one or more lines, that describe the
    locations of the walls. For each such wall the four parameters
    <span class="tex2jax_process">$(x_1,y_1)$</span>, <span class="tex2jax_process">$(x_2,y_2)$</span> describe the locations of
    two ends of the wall. Each wall replaces a linear sequence of
    adjoining tiles and is either axis-aligned or intersects both
    axes at a <span class="tex2jax_process">$45$</span> degree
    angle. Diagonal walls are modeled as a sequence of cells that
    would just be touching corner to corner. If the two endpoints
    of a wall are the same, the wall just occupies the single cell
    at that location. Walls may intersect with each other, but no
    leak is over a wall.</p>
<p>A line with a single integer <span class="tex2jax_process">$-1$</span> designates the end of the
    input.</p>
<h2>Output</h2>
<p>For each house, display the total number of tiles that are
    wet after <span class="tex2jax_process">$T$</span> minutes.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>12 12 5 3 5
2 11 3 3 9 5
1 9 6 9 1 7 4 4 7 1 7 4
10 9 10 12 11 4 12 4
9 7 8 1 3
4 3
2 2 6 6 6 2 2 6 8 2 8 2
6 7 50 1 3
3 4
2 2 2 6 3 6 5 4 5 4 3 2
12 12 5 3 0
2 11 3 3 9 5
-1
</pre>
</td>
<td>
<pre>75
17
4
94
</pre>
</td>
</tr>
</table>
</div>