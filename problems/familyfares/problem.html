<div class="problembody">
<p>After a long time apart, your family will gather next year
    for a reunion in an idyllic village in the centre of the
    country. Since everybody lives apart, most will need to travel
    by train.</p>
<p>You are in charge of finding the best deal on tickets.
    Everyone must take an optimal route, that is to say they may
    only travel a route if no other route is shorter.</p>
<p>Two types of ticket are available: <em>individual</em> or
    <em>group</em>. All tickets come with a start and destination
    between which to travel. Individual tickets are unlimited and
    the price is equal to the shortest distance in kilometres
    between stations.</p>
<p>Group tickets are more complicated. First, you may only buy
    at most one and it must be for a set list of people. There is
    no limit to the number of people named, but all must be
    present. The ticket is priced according to the number of named
    persons.</p>
<div class="figure" id="a0000000004">
<center>
<img alt="\includegraphics[width=0.5\textwidth ]{figure}" src="/problems/familyfares/file/statement/en/img-0001.png" style="width:50.00%"/>
<div class="caption">
<b>Figure 1</b>: Sample 2. Group or individual tickets
          are shown by thick or thin lines, respectively.
        </div>
</center>
</div>
<h2>Input</h2>
<ul class="itemize">
<li>
<p>One line with four integers: <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$2 \le n \le 1000$</span>), the number of
        stations, <span class="tex2jax_process">$m$</span>
        (<span class="tex2jax_process">$n-1 \le m \le
        10^5$</span>), the number of connections between stations,
        <span class="tex2jax_process">$p$</span> (<span class="tex2jax_process">$1 \le p \le 100$</span>), the number of
        family members, and <span class="tex2jax_process">$g$</span> (<span class="tex2jax_process">$1 \le g \le 10^6$</span>), the cost per
        person of a group ticket.</p>
</li>
<li>
<p>One line with <span class="tex2jax_process">$p$</span>
        integers <span class="tex2jax_process">$v_ i$</span>
        (<span class="tex2jax_process">$1 \le v \le n$</span>),
        meaning that family member <span class="tex2jax_process">$i$</span> starts at station <span class="tex2jax_process">$v_ i$</span>.</p>
</li>
<li>
<p><span class="tex2jax_process">$m$</span> further lines,
        each with three integers <span class="tex2jax_process">$a$</span>, <span class="tex2jax_process">$b$</span>, and <span class="tex2jax_process">$c$</span> (<span class="tex2jax_process">${1 \le a,b \le n}$</span>, <span class="tex2jax_process">$a\neq b$</span>, and <span class="tex2jax_process">${1 \le c \le 10^6}$</span>), indicating
        that there is a bidirectional connection between stations
        <span class="tex2jax_process">$a$</span> and <span class="tex2jax_process">$b$</span> with a length of <span class="tex2jax_process">$c$</span> kilometres.</p>
</li>
</ul>
<p>Each pair of distinct stations has at most one direct
    connection and every station can be reached from any other
    station. Station number <span class="tex2jax_process">$1$</span> serves the idyllic village.</p>
<h2>Output</h2>
<p>Output the total amount you must spend so that every family
    member can travel from their starting station to the idyllic
    village.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>6 5 3 10
4 5 6
1 2 10
2 3 10
3 4 10
4 5 2
4 6 3
</pre>
</td>
<td>
<pre>35
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>7 7 4 10
5 4 4 7
1 2 100
2 3 100
3 4 10
1 5 80
3 5 30
3 6 10
6 7 5
</pre>
</td>
<td>
<pre>145
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 3</th>
<th>Sample Output 3</th>
</tr>
<tr>
<td>
<pre>4 5 2 10
2 4
1 2 20
2 4 5
1 3 20
3 4 5
1 4 30
</pre>
</td>
<td>
<pre>25
</pre>
</td>
</tr>
</table>
</div>