<div class="problembody">
<p>Modulo Solitaire is a game that can be played when you are
    bored. You can even play it without a phone, just on paper.
    First, you pick a number <span class="tex2jax_process">$m$</span>. Then you pick two sequences of
    numbers <span class="tex2jax_process">$a_{i}$</span> and
    <span class="tex2jax_process">$b_{i}$</span>. Finally, you pick
    a starting number <span class="tex2jax_process">$s_{0}$</span>.
    Now, your goal is to go from <span class="tex2jax_process">$s_{0}$</span> to <span class="tex2jax_process">$0$</span> in as few moves as possible. In
    each move, you choose an <span class="tex2jax_process">$i$</span>, then multiply your current number
    by <span class="tex2jax_process">$a_{i}$</span>, add
    <span class="tex2jax_process">$b_{i}$</span> to it, and reduce
    the result modulo <span class="tex2jax_process">$m$</span>.
    That is, <span class="tex2jax_process">$s_{j} = (s_{j-1} \cdot
    a_{i_{j}} + b_{i_{j}}) \bmod {m}$</span>.</p>
<h2>Input</h2>
<p>The first line of input contains three integers <span class="tex2jax_process">$1 \le m \le 10^6$</span>, <span class="tex2jax_process">$0 \le n \le 10$</span>, and <span class="tex2jax_process">$1 \le s_{0} &lt; m$</span>. The next
    <span class="tex2jax_process">$n$</span> lines each contain two
    integers, a pair <span class="tex2jax_process">$0 \le a_ i \le
    10^9$</span> and <span class="tex2jax_process">$0 \le b_ i \le
    10^9$</span>.</p>
<h2>Output</h2>
<p>Output a single integer, the minimum number of moves needed
    to reach <span class="tex2jax_process">$0$</span> starting from
    <span class="tex2jax_process">$s_0$</span>. If it is not
    possible to reach <span class="tex2jax_process">$0$</span> in
    any number of moves, output <span class="tex2jax_process">$-1$</span>.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>5 2 1
2 1
3 1
</pre>
</td>
<td>
<pre>2
</pre>
</td>
</tr>
</table>
</div>