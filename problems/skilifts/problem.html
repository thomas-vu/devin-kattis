<div class="problembody">
<div class="illustration" style="width:35.00%">
<img alt="/problems/skilifts/file/statement/en/img-0001.jpg" class="illustration" src="/problems/skilifts/file/statement/en/img-0001.jpg"/>
<div class="description">
<a href="https://commons.wikimedia.org/wiki/File:Hoodoo-Ski-Area-Central-Oregon-Resort-Big-Green-Machine-Chair-Lift.jpg">
        Picture</a> by SkiHoodoo from Wikimedia Commons, cc by-sa
      </div>
</div>Last winter, an avalanche swept away all the ski lifts
    from the ski resort Valen. Instead of rebuilding the lifts like
    they were before, the plan is to do it in a more optimized way,
    and you are responsible for this.
    <p>The only thing remaining from the old lift system are
    <span class="tex2jax_process">$n$</span> pylons situated at
    integer coordinates in the plane. You would like to put lifts
    in the form of line segments between some of these pylons. The
    line segments must satisfy the following constraints:</p>
<ol class="enumerate">
<li>
<p>A line segment can only go between pylons <span class="tex2jax_process">$(x_1, y_1)$</span> and <span class="tex2jax_process">$(x_2, y_2)$</span> if <span class="tex2jax_process">$|y_1-y_2| = 1$</span>.</p>
</li>
<li>
<p>There are two types of pylons, one-way and two-way
        pylons. The one-way pylons can be connected to at most one
        other pylon, and the two-way pylons can be connected to at
        most two other pylons. However, if a two-way pylon
        <span class="tex2jax_process">$i$</span> is connected to
        two other pylons, then they must be on opposite sides of
        <span class="tex2jax_process">$i$</span> in the
        <span class="tex2jax_process">$y$</span>-direction. In
        other words, the two pylons connected to <span class="tex2jax_process">$i$</span> must have different
        <span class="tex2jax_process">$y$</span>-coordinates.</p>
</li>
<li>
<p>Two line segments may not intersect (except that the two
        line segments incident on a two-way pylon may touch at
        their endpoints).</p>
</li>
</ol>
<p>What is the maximum number of ski lifts (line segments) you
    can place under these constraints?</p>
<h2>Input</h2>
<p>The first line contains one integer <span class="tex2jax_process">$n$</span> (<span class="tex2jax_process">$1
    \leq n \leq 10^5$</span>). Each of the following <span class="tex2jax_process">$n$</span> lines contains three integers
    <span class="tex2jax_process">$x$</span>, <span class="tex2jax_process">$y$</span>, and <span class="tex2jax_process">$a$</span>, the coordinates and type of a
    pylon (<span class="tex2jax_process">$0 \leq x,y \leq
    10^5$</span>; <span class="tex2jax_process">$a=1$</span> for a
    one-way pylon and <span class="tex2jax_process">$a=2$</span>
    for a two-way pylon). All the pylons are situated at different
    coordinates.</p>
<h2>Output</h2>
<p>Output the maximum number of ski lift line segments that can
    be placed.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>8
1 0 1
3 0 2
0 1 1
2 1 2
4 1 2
1 2 2
2 3 1
4 3 1
</pre>
</td>
<td>
<pre>4
</pre>
</td>
</tr>
</table>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 2</th>
<th>Sample Output 2</th>
</tr>
<tr>
<td>
<pre>4
0 0 1
100000 1 1
0 99999 1
100000 100000 1
</pre>
</td>
<td>
<pre>2
</pre>
</td>
</tr>
</table>
</div>