<div class="problembody">
<div class="illustration" style="width:35.00%">
<img alt="/problems/pedalpower/file/statement/en/img-0001.png" class="illustration" src="/problems/pedalpower/file/statement/en/img-0001.png"/>
<div class="description">
        Photo courtesy of Christy Coghlan
      </div>
</div>
<p>You’re ready to start your semester off right! Well,
    almost … you have everything listed on your calendar, you
    just bought a brand new bike, but you haven’t yet planned your
    commute! You are quite busy this semester, and so you decide to
    plan a route for all your classes and appointments which
    requires the least amount of travel time. You know how long
    certain routes take with and without a bike. You can choose to
    ride or not ride your bike at any point, but if you leave your
    bike somewhere you must return to the same location to pick it
    up before riding the bike again. Additionally, you can’t carry
    your bike on non-bike routes. What is the shortest amount of
    cumulative time it takes to travel to all the places you need
    to go and return you and the bike to your starting
    location?</p>
<div class="figure" id="fig:s1">
<center>
<img alt="\includegraphics[width=.30\textwidth ]{graph_image}" src="/problems/pedalpower/file/statement/en/img-0002.png" style="width:30.00%"/>
<div class="caption">
<b>Figure 1</b>: This figure shows sample input
          <span class="tex2jax_process">$1$</span>, with bike paths
          in red/curved and non-bike paths in black/straight.
        </div>
</center>
</div>
<h2>Input</h2>
<p>The problem input describes a multigraph with two different
    types of edges: edges for bike paths and edges for non-bike
    paths.</p>
<p>The first line contains one integer <span class="tex2jax_process">$n$</span>, <span class="tex2jax_process">$0
    &lt; n \leq 300$</span>, the number of locations on campus. The
    locations are numbered from <span class="tex2jax_process">$0$</span> to <span class="tex2jax_process">$n-1$</span>. Location <span class="tex2jax_process">$0$</span> is your home, which is the
    starting and ending location of you and your bike.</p>
<p>The second line contains one integer <span class="tex2jax_process">$x$</span>, <span class="tex2jax_process">$0
    &lt; x \leq n(n-1)/2$</span>, the number of bike paths.</p>
<p>Each of the next <span class="tex2jax_process">$x$</span>
    lines contains a description of a bike path. Each line has
    <span class="tex2jax_process">$3$</span> integers <span class="tex2jax_process">$u$</span> <span class="tex2jax_process">$v$</span> <span class="tex2jax_process">$t$</span>, where <span class="tex2jax_process">$0 \leq u &lt; n$</span> is the starting
    location of the path, <span class="tex2jax_process">$0 \leq v
    &lt; n$</span> is the ending location of the path, and
    <span class="tex2jax_process">$0 \leq t \leq 10^6$</span> is
    the time it takes to travel from <span class="tex2jax_process">$u$</span> to <span class="tex2jax_process">$v$</span> and from <span class="tex2jax_process">$v$</span> to <span class="tex2jax_process">$u$</span> by bike.</p>
<p>The next line contains one integer <span class="tex2jax_process">$y$</span>, <span class="tex2jax_process">$0
    &lt; y \leq n(n-1)/2$</span>, the number of non-bike paths.</p>
<p>Each of the next <span class="tex2jax_process">$y$</span>
    lines contains a description of a non-bike path. Each line has
    <span class="tex2jax_process">$3$</span> integers <span class="tex2jax_process">$u$</span> <span class="tex2jax_process">$v$</span> <span class="tex2jax_process">$t$</span>, where <span class="tex2jax_process">$0 \leq u &lt; n$</span> is the index of the
    starting location of the path, <span class="tex2jax_process">$0
    \leq v &lt; n$</span> is the index of the ending location of
    the path, and <span class="tex2jax_process">$t \leq
    10^6$</span> is the time it takes to travel from <span class="tex2jax_process">$u$</span> to <span class="tex2jax_process">$v$</span> and from <span class="tex2jax_process">$v$</span> to <span class="tex2jax_process">$u$</span> using a bike alternative.</p>
<p>All paths can be taken in either direction, and the amount
    of time it takes to travel in either direction of the same path
    is the same. There are at most one bike path and at most one
    non-bike path between any two locations. No path starts and
    ends at the same location.</p>
<p>The next line contains an integer <span class="tex2jax_process">$z$</span>, <span class="tex2jax_process">$0
    &lt; z \leq 300$</span>, indicating the number of locations you
    have to visit on your route. The next line contains
    <span class="tex2jax_process">$z$</span> integers <span class="tex2jax_process">$0 \leq a_1, a_2, \ldots , a_ z &lt;
    n$</span>, the indices of the locations you must visit. The
    locations must be visited in the order in which they are
    listed, but there are no restrictions on how often you may pass
    through any location on your trip.</p>
<h2>Output</h2>
<p>Output the minimum possible cumulative travel time, with you
    and the bike starting and ending at location <span class="tex2jax_process">$0$</span>. You are guaranteed that all
    locations on your route can be reached using some combination
    of bike and non-bike paths.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>4
4
0 1 2
3 1 10
2 3 2
2 0 10
4
1 0 11
3 1 3
2 3 11
2 0 3
3
1 3 2
</pre>
</td>
<td>
<pre>16
</pre>
</td>
</tr>
</table>
</div>