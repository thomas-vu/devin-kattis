<div class="problembody">
<div class="illustration" style="width:30.00%">
<img alt="/problems/pandachess/file/statement/en/img-0001.jpg" class="illustration" src="/problems/pandachess/file/statement/en/img-0001.jpg"/>
<div class="description">
        Photo by <a href="https://www.pinterest.com/brandiibear/">brandiibear</a>
        from Pinterest
      </div>
</div>
<p>In the city of Pandaville, the predominant black and white
    colours of the inhabitants have somehow made chess a very
    popular game in the area. There are a total of <span class="tex2jax_process">$N$</span> chess players in the city and they
    are very competitive. Recently, the annual Panda Chess
    Tournament has just ended where a total of <span class="tex2jax_process">$M$</span> matches have been played among the
    players to decide who is the best chess player. This has
    resulted in a unique ranking among the players such that for
    every match, the winner has a higher rank than the loser. The
    ranking will be published on <i class="itshape">The Daily
    Chess</i> tomorrow.</p>
<p>Each chess player is identified by his/her unique IC number
    which is a number containing at most <span class="tex2jax_process">$D$</span> digits from <span class="tex2jax_process">$0$</span> to <span class="tex2jax_process">$9$</span>. The ranking is a list of IC
    numbers ordered by their relative ranks with the top player
    being the first in the list.</p>
<p>The ranking list published is typed by a panda writer using
    a typewriter. Due to his fat paws, the panda writer makes a lot
    of mistakes. You are asked to amend the ranking list.
    <span class="tex2jax_process">$1$</span> edit is defined as
    either removing an IC number or inserting an IC number into the
    list. You aim to find out what is the least number of edits
    required to correct the ranking list.</p>
<h2>Input</h2>
<p>The input consists of:</p>
<ul class="itemize">
<li>
<p>One line with three integers <span class="tex2jax_process">$N$</span> (<span class="tex2jax_process">$2 \le N \le 100\, 000$</span>),
        <span class="tex2jax_process">$M$</span> (<span class="tex2jax_process">$1 \le M \le 200\, 000$</span>) and
        <span class="tex2jax_process">$D$</span> (<span class="tex2jax_process">$1 \le D \le 10$</span>), where
        <span class="tex2jax_process">$N$</span> is the number of
        chess players, <span class="tex2jax_process">$M$</span> is
        the number of matches played, and <span class="tex2jax_process">$D$</span> is the maximum number of
        digits for each IC number;</p>
</li>
<li>
<p><span class="tex2jax_process">$M$</span> lines each with
        two IC numbers <span class="tex2jax_process">$A$</span> and
        <span class="tex2jax_process">$B$</span>, indicating that
        panda A wins over panda B;</p>
</li>
<li>
<p><span class="tex2jax_process">$N$</span> lines each with
        one IC number <span class="tex2jax_process">$C$</span>,
        representing the ranking list typed by the panda
        writer;</p>
</li>
</ul>
<p>It is guaranteed that the <span class="tex2jax_process">$M$</span> matches define one unique ranking
    for the <span class="tex2jax_process">$N$</span> pandas and
    every match will be played between <span class="tex2jax_process">$2$</span> different players. However,
    <span class="tex2jax_process">$2$</span> players can play more
    than once.</p>
<h2>Output</h2>
<p>Output one line with a single integer: the minimum number of
    edits required to obtain the actual ranking list from the
    original ranking list typed by the panda writer.</p>
<table class="sample" summary="sample data">
<tr>
<th>Sample Input 1</th>
<th>Sample Output 1</th>
</tr>
<tr>
<td>
<pre>
4 4 3
345 678
12 345
345 678
678 999
999
12
824
999
</pre>
</td>
<td>
<pre>
4
</pre>
</td>
</tr>
</table>
</div>